!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/build/",n(n.s="bUFL")}({"0/Wv":function(e,t,n){window,e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){var i,r,o;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */o=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(i){function r(){}function o(t,n,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=i.write?i.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var l in o)o[l]&&(s+="; "+l,!0!==o[l]&&(s+="="+o[l].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),l=s.slice(1).join("=");n||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var u=t(s[0]);if(l=(i.read||i)(l,u)||t(l),n)try{l=JSON.parse(l)}catch(e){}if(r[u]=l,e===u)break}catch(e){}}return e?r[e]:r}}return r.set=o,r.get=function(e){return a(e,!1)},r.getJSON=function(e){return a(e,!0)},r.remove=function(t,n){o(t,"",e(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}((function(){}))},void 0===(r="function"==typeof(i=o)?i.call(t,n,t,e):i)||(e.exports=r),e.exports=o()},function(e,t,n){(function(n){var i;!function(n,r){e.exports=function(n){"use strict";var r,o=(n=n||{}).Base64,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(e){for(var t={},n=0,i=e.length;n<i;n++)t[e.charAt(n)]=n;return t}(a),l=String.fromCharCode,u=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},d=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(e){return e.replace(d,u)},h=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[a.charAt(n>>>18),a.charAt(n>>>12&63),t>=2?"=":a.charAt(n>>>6&63),t>=1?"=":a.charAt(63&n)].join("")},f=n.btoa&&"function"==typeof n.btoa?function(e){return n.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,h)},p=function(e){return f(c(String(e)))},g=function(e){return e.replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,"")},v=function(e,t){return t?g(p(e)):p(e)};n.Uint8Array&&(r=function(e,t){for(var n="",i=0,r=e.length;i<r;i+=3){var o=e[i],s=e[i+1],l=e[i+2],u=o<<16|s<<8|l;n+=a.charAt(u>>>18)+a.charAt(u>>>12&63)+(void 0!==s?a.charAt(u>>>6&63):"=")+(void 0!==l?a.charAt(63&u):"=")}return t?g(n):n});var y,b=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,m=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return l(55296+(t>>>10))+l(56320+(1023&t));case 3:return l((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return l((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},w=function(e){return e.replace(b,m)},E=function(e){var t=e.length,n=t%4,i=(t>0?s[e.charAt(0)]<<18:0)|(t>1?s[e.charAt(1)]<<12:0)|(t>2?s[e.charAt(2)]<<6:0)|(t>3?s[e.charAt(3)]:0),r=[l(i>>>16),l(i>>>8&255),l(255&i)];return r.length-=[0,0,2,1][n],r.join("")},S=n.atob&&"function"==typeof n.atob?function(e){return n.atob(e)}:function(e){return e.replace(/\S{1,4}/g,E)},k=function(e){return S(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},_=function(e){return String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")},A=function(e){return function(e){return w(S(e))}(_(e))};if(n.Uint8Array&&(y=function(e){return Uint8Array.from(k(_(e)),(function(e){return e.charCodeAt(0)}))}),n.Base64={VERSION:"2.6.4",atob:k,btoa:f,fromBase64:A,toBase64:v,utob:c,encode:v,encodeURI:function(e){return v(e,!0)},btou:w,decode:A,noConflict:function(){var e=n.Base64;return n.Base64=o,e},fromUint8Array:r,toUint8Array:y},"function"==typeof Object.defineProperty){var O=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};n.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",O((function(){return A(this)}))),Object.defineProperty(String.prototype,"toBase64",O((function(e){return v(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",O((function(){return v(this,!0)})))}}return n.Meteor&&(Base64=n.Base64),e.exports?e.exports.Base64=n.Base64:void 0===(i=function(){return n.Base64}.apply(t,[]))||(e.exports=i),{Base64:n.Base64}}(n)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:this)}).call(this,n(3))},function(e,t,n){"use strict";var i;e.exports.timeout=function(e,t){var n,r=new i;return Promise.race([e,new Promise((function(e,i){n=setTimeout((function(){i(r)}),t)}))]).then((function(e){return clearTimeout(n),e}),(function(e){throw clearTimeout(n),e}))},(i=e.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"}).prototype=Object.create(Error.prototype),i.prototype.name="TimeoutError"},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t),n.d(t,"Central",(function(){return J})),n.d(t,"User",(function(){return l})),n.d(t,"ConsoleLogger",(function(){return Y})),n.d(t,"UserData",(function(){return U}));var i,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="CentralError",i}return r(t,e),t}(Error),a=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),s=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="InvalidRoleError",i}return a(t,e),t}(o),l=function(){function e(e,t,n,i,r){this._email=null,this._confirmed=null,this._postInbox=null,this._subscriptionRoles=new Map,this._id=e,this._email=t,this._confirmed=n,this._postInbox=i,this._subscriptionRoles=r}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"email",{get:function(){return this._email},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"confirmed",{get:function(){return this._confirmed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"postInbox",{get:function(){return this._postInbox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subscriptionRoles",{get:function(){return this._subscriptionRoles},enumerable:!1,configurable:!0}),e.prototype.hasSubscriptionRole=function(e){return this.subscriptionRoles.has(e)},e.prototype.hasActiveSubscriptionRole=function(e){if(!this.hasSubscriptionRole(e))return!1;var t=this.getSubscriptionRole(e);return!t.isExpired()&&!t.deviceLimitReached},e.prototype.hasActiveSubscriptionRoles=function(e){var t=this;return e.every((function(e){return t.hasActiveSubscriptionRole(e)}))},e.prototype.getSubscriptionRole=function(e){if(!this.hasSubscriptionRole(e))throw new s('Subscription role with name "'+e+'" does not exist.');return this.subscriptionRoles.get(e)},e}(),u=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),d=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i._apiResponse=null,i.stack=new Error(t[0]).stack,i.name="TokenLoadFailedError",i}return u(t,e),Object.defineProperty(t.prototype,"apiResponse",{get:function(){return this._apiResponse},set:function(e){this._apiResponse=e},enumerable:!1,configurable:!0}),t}(o),c=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),h=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="InvalidJsonError",i}return c(t,e),t}(d),f=function(){function e(){}return e.toInt=function(e){if(/^[-+]?(\d+|Infinity)$/.test(e)){var t=Number(e);if(isNaN(t))throw new o('"'+e+'" is not valid integer.');return t}throw new o('"'+e+'" is not valid integer.')},e.isInt=function(t){try{return e.toInt(t),!0}catch(e){return!1}},e.parseJson=function(e){try{return JSON.parse(e)}catch(e){throw new h(e.message)}},e}(),p=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),g=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="TokenUpdateTimeoutError",i}return p(t,e),t}(d),v=function(){function e(e,t,n){void 0===n&&(n=!1),this._deviceLimitReached=!1,this._name=e,this._expireAt=t,this._deviceLimitReached=n}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expireAt",{get:function(){return this._expireAt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceLimitReached",{get:function(){return this._deviceLimitReached},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ttl",{get:function(){var e=new Date,t=Math.floor((this._expireAt.getTime()-e.getTime())/1e3);return 0>t?0:t},enumerable:!1,configurable:!0}),e.prototype.isExpired=function(){return this.ttl<=0},e}(),y=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),b=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="TokenInvalidError",i}return y(t,e),t}(d),m=function(){function e(e,t,n,i,r,o,a,s,l){this._email=null,this._confirmed=null,this._postInbox=null,this._subscriptionRoles=new Map,this._id=e,this._subject=t,this._issuedAt=n,this._expireAt=i,this._audience=r,this._email=o,this._confirmed=a,this._postInbox=s,this._subscriptionRoles=l}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subject",{get:function(){return this._subject},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"issuedAt",{get:function(){return this._issuedAt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expireAt",{get:function(){return this._expireAt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"audience",{get:function(){return this._audience},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"email",{get:function(){return this._email},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"confirmed",{get:function(){return this._confirmed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"postInbox",{get:function(){return this._postInbox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subscriptionRoles",{get:function(){return this._subscriptionRoles},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ttl",{get:function(){var e=new Date,t=Math.floor((this.expireAt.getTime()-e.getTime())/1e3);return 0>t?0:t},enumerable:!1,configurable:!0}),e.createFromUserJwtPayload=function(t){e.checkJwtPayload(t);var n=null;Object.prototype.hasOwnProperty.call(t,"eml")&&t.eml&&(n=t.eml);var i=null;Object.prototype.hasOwnProperty.call(t,"cnf")&&(i=t.cnf);var r=null;Object.prototype.hasOwnProperty.call(t,"pst")&&t.pst&&(r=t.pst);var o=new Map;return Object.prototype.hasOwnProperty.call(t,"sbr")&&t.sbr&&Object.keys(t.sbr).forEach((function(e){if(t.sbr){var n=t.sbr[e],i=!1;Object.prototype.hasOwnProperty.call(n,"dlr")&&n.dlr&&(i=n.dlr),o.set(e,new v(e,new Date(1e3*n.exp),i))}})),new e(t.jti,t.sub,new Date(1e3*t.iat),new Date(1e3*t.exp),t.aud,n,i,r,o)},e.checkJwtPayload=function(e){["sub","iat","exp","jti","aud"].forEach((function(t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new b('The JWT token is invalid. Claim "'+t+'" is missing.')}))},e.prototype.isFresh=function(){return this.ttl>0},e}(),w=n(1),E=function(){function e(){this.logger=null}return e.prototype.setLogger=function(e){this.logger=e},e.prototype.tokenToUserPayload=function(e){this.log("parsing...",e);var t=m.createFromUserJwtPayload(this.parseJwt(e));return this.log("UserPayload from parsed JWT created",t),t},e.prototype.parseJwt=function(e){return this.parseJson(this.base64UrlDecode(e))},e.prototype.base64UrlDecode=function(e){var t=e.split(".");if(2!==t.length)throw new b("JWT token should contain header and payload separated with dot. But "+(t.length-1)+" dots found.");try{return w.Base64.decode(t[1])}catch(e){throw new b("JWT Payload base64url decode failed with error: "+e.message)}},e.prototype.parseJson=function(e){try{return f.parseJson(e)}catch(e){throw new b("JWT Payload JSON decode failed with error: "+e.message)}},e.prototype.log=function(e,t){null!==this.logger&&this.logger.debug("JwtParser",e,t)},e}(),S=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),k=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="UserNotLoggedInError",i}return S(t,e),t}(d),_=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),A=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="TokenUpdateRefusedError",i}return _(t,e),t}(d),O=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),C=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="TokenAlreadyUpdatingError",i}return O(t,e),t}(d),I=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n={}),this._result=e,this._message=t,this._data=n}return Object.defineProperty(e.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),e}(),T=n(0),P=function(){function e(e){this.userPayloadCache=null,this.userPayloadRawCache=null,this.status="init",this.plannerId=null,this.reloadPromise=null,this.lastApiCallAt=null,this.logger=null,this.config=e}return e.prototype.setLogger=function(e){this.logger=e},e.prototype.refreshTokenAfter=function(e){var t=this;this.log("refreshTokenAfter("+e+")");var n=1e3*e,i=this.generateRandomInt(n,n+500);return this.log("randomize setTimeout("+i+")"),new Promise((function(e,n){null!==t.plannerId&&(t.log("clearing previous timeout"),clearTimeout(t.plannerId),t.plannerId=null),t.plannerId=setTimeout((function(){t.onPlannedTimeRefresh(e,n)}),i)}))},e.prototype.loadToken=function(){var e=this;return this.log("loadToken()"),new Promise((function(t,n){var i=e.parseFromCookie();i?t(i):"updating"!==e.status||null===e.reloadPromise?e.reload().then((function(e){return t(e)})).catch((function(e){return n(e)})):e.reloadPromise.then((function(n){t(n),e.reloadPromise=null})).catch((function(e){return n(e)}))}))},e.prototype.refreshToken=function(){return this.log("refreshToken()"),this.reload()},e.prototype.clearCache=function(){this.log("clearCache()"),this.userPayloadCache=null,this.userPayloadRawCache=null,this.lastApiCallAt=null},e.prototype.parseFromCookie=function(){this.log("_parseFromCookie()");var e=T.get("ppp");if(null!==this.userPayloadRawCache&&null!==this.userPayloadCache&&e===this.userPayloadRawCache&&this.userPayloadCache.isFresh())return this.log("Found userPayload in cookie, but used from inmemory cache because it`s the same and fresh"),this.userPayloadCache;if(e){if(this.userPayloadRawCache=e,!this.userPayloadRawCache)throw new o("Invalid state.");var t=new E;return t.setLogger(this.logger),this.userPayloadCache=t.tokenToUserPayload(this.userPayloadRawCache),this.userPayloadCache.isFresh()?(this.log("UserPayload in cookie accepted"),this.userPayloadCache):(this.log("UserPayload in cookie is not fresh"),null)}return this.log("No UserPayload in cookies found"),null},e.prototype.reload=function(){var e=this;return this.log("reload()"),this.reloadPromise=new Promise((function(t,n){try{e.validate(),e.status="updating";var i=new XMLHttpRequest;i.ontimeout=function(){return e.onTimeout(n)},i.onerror=function(){return e.onError(i,n)},i.onload=function(){200===i.status?e.onSuccess(i,t,n):e.onError(i,n)},e.lastApiCallAt=new Date,i.open("POST",e.config.tokenUpdateUrl+"?url="+encodeURIComponent(window.location.href),!0),i.timeout=7e3,i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-Type","application/json"),i.withCredentials=!0,i.send(),e.log("Ajax request to "+e.config.tokenUpdateUrl)}catch(e){n(e)}})),this.reloadPromise},e.prototype.onPlannedTimeRefresh=function(e,t){var n=this;if(this.log("Running planned refreshToken() in specific time"),this.plannerId=null,"updating"===this.status&&null!==this.reloadPromise)return this.log("token is already updating, wait for the result"),void this.reloadPromise.then((function(t){e(t),n.reloadPromise=null})).catch((function(e){return t(e)}));this.log("Refreshing token in specific time"),this.refreshToken().then((function(t){return e(t)})).catch((function(e){return t(e)}))},e.prototype.onSuccess=function(e,t,n){var i=this;this.log("Ajax success");var r=e.responseText;r&&this.log("Ajax response: ",r);var o=this.parseFromCookie();if(o)return this.status="success",void t(o);this.log("JWT Cookies not found. We will try to check it again after some time to make sure."),setTimeout((function(){var e=i.parseFromCookie();if(e)return i.status="success",void t(e);i.log("JWT Cookies in response missing or were not accepted by browser."),i.status="error",n(new d("No fresh user payload found."))}),1)},e.prototype.onTimeout=function(e){this.log("Ajax failed with timeout."),this.status="timeout",e(new g("HTTP API timeout."))},e.prototype.onError=function(e,t){this.log("Ajax error. Response status code: "+e.status),this.status="error";var n=new d("HTTP API Error."),i=this.responseToApiResponse(e.responseText);i&&(n.apiResponse=i),t(n)},e.prototype.validate=function(){this.log("validating...");var e=T.get("ppu");if(!(e&&"1"===e||T.get("ppi")))throw new k("User is not logged in.");if("error"===this.status&&null!==this.lastApiCallAt){var t=new Date,n=Math.round((t.getTime()-this.lastApiCallAt.getTime())/1e3);if(this.config.waitTimeInCaseOfApiError>n)throw new A("Last API call ended with error. New API call can be done after "+(this.config.waitTimeInCaseOfApiError-n)+" seconds.")}if("timeout"===this.status&&null!==this.lastApiCallAt&&(t=new Date,n=Math.round((t.getTime()-this.lastApiCallAt.getTime())/1e3),this.config.waitTimeInCaseOfApiTimeout>n))throw new A("Last API call ended with timeout. New API call can be done after "+(this.config.waitTimeInCaseOfApiTimeout-n)+" seconds.");if("updating"===this.status)throw new C("The token is already updating.");this.log("passed")},e.prototype.responseToApiResponse=function(e){this.log("responseToApiResponse()");try{var t=this.parseJson(e);if(!Object.prototype.hasOwnProperty.call(t,"status"))throw new d('Response json does not contain expected field "status".');var n=t.status,i=null,r={};return Object.prototype.hasOwnProperty.call(t,"message")&&(i=t.message),Object.prototype.hasOwnProperty.call(t,"data")&&(r=t.data),new I(n,i,r)}catch(e){return this.log("Error: Response converting to ApiResponse failed with error:"+e.message),null}},e.prototype.parseJson=function(e){try{return f.parseJson(e)}catch(e){throw new b("Response JSON decode failed with error: "+e.message)}},e.prototype.generateRandomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.prototype.log=function(e,t){null!==this.logger&&this.logger.debug("TokenLoader",e,t)},e}(),R=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),L=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="ConfigInvalidError",i}return R(t,e),t}(o),D=function(){function e(e){this._refreshBeforeExpire=!1,this._waitTimeInCaseOfApiError=120,this._waitTimeInCaseOfApiTimeout=1800,this._refreshTokenPeriodBeforeExpire=180,this._refreshOnFocus=!1,this._shareTokenLoader=!0,this._sharedIframeUrl=null,this._userDataFetchUrl=null,this._tokenUpdateUrl=e.tokenUpdateUrl,this.configureTokenLoader(e),this.configureUserDataLoader(e)}return e.prototype.configureTokenLoader=function(e){if(Object.prototype.hasOwnProperty.call(e,"waitTimeInCaseOfApiError")&&void 0!==e.waitTimeInCaseOfApiError&&(this._waitTimeInCaseOfApiError=e.waitTimeInCaseOfApiError),Object.prototype.hasOwnProperty.call(e,"waitTimeInCaseOfApiTimeout")&&void 0!==e.waitTimeInCaseOfApiTimeout&&(this._waitTimeInCaseOfApiTimeout=e.waitTimeInCaseOfApiTimeout),Object.prototype.hasOwnProperty.call(e,"refreshTokenPeriodBeforeExpire")&&void 0!==e.refreshTokenPeriodBeforeExpire){if(e.refreshTokenPeriodBeforeExpire<10)throw new L('Min config value for "refreshTokenPeriodBeforeExpire" should be 10, but '+e.refreshTokenPeriodBeforeExpire+" provided.");this._refreshTokenPeriodBeforeExpire=e.refreshTokenPeriodBeforeExpire}Object.prototype.hasOwnProperty.call(e,"refreshBeforeExpire")&&void 0!==e.refreshBeforeExpire&&(this._refreshBeforeExpire=e.refreshBeforeExpire),Object.prototype.hasOwnProperty.call(e,"refreshOnFocus")&&void 0!==e.refreshOnFocus&&(this._refreshOnFocus=e.refreshOnFocus),Object.prototype.hasOwnProperty.call(e,"shareTokenLoader")&&void 0!==e.shareTokenLoader&&(this._shareTokenLoader=e.shareTokenLoader)},e.prototype.configureUserDataLoader=function(e){Object.prototype.hasOwnProperty.call(e,"sharedIframeUrl")&&void 0!==e.sharedIframeUrl&&(this._sharedIframeUrl=e.sharedIframeUrl),Object.prototype.hasOwnProperty.call(e,"userDataFetchUrl")&&void 0!==e.userDataFetchUrl&&(this._userDataFetchUrl=e.userDataFetchUrl)},Object.defineProperty(e.prototype,"tokenUpdateUrl",{get:function(){return this._tokenUpdateUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"waitTimeInCaseOfApiError",{get:function(){return this._waitTimeInCaseOfApiError},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"waitTimeInCaseOfApiTimeout",{get:function(){return this._waitTimeInCaseOfApiTimeout},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"refreshBeforeExpire",{get:function(){return this._refreshBeforeExpire},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"refreshTokenPeriodBeforeExpire",{get:function(){return this._refreshTokenPeriodBeforeExpire},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"refreshOnFocus",{get:function(){return this._refreshOnFocus},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shareTokenLoader",{get:function(){return this._shareTokenLoader},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sharedIframeUrl",{get:function(){return this._sharedIframeUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userDataFetchUrl",{get:function(){return this._userDataFetchUrl},enumerable:!1,configurable:!0}),e}(),U=function(){function e(){this._id=null,this._createdAt=null,this._email=null,this._hashedEmail=null,this._phone=null,this._subscribedNewslettersVariants=null,this._rawData=null}return e.createFromRawData=function(t){var n=new e;return n.initWithRawData(t),n},e.prototype.initWithRawData=function(e){Object.prototype.hasOwnProperty.call(e,"central_user_id")&&(this._id=e.central_user_id),Object.prototype.hasOwnProperty.call(e,"user_created_at")&&(this._createdAt=new Date(e.user_created_at)),Object.prototype.hasOwnProperty.call(e,"email")&&(this._email=e.email),Object.prototype.hasOwnProperty.call(e,"hashed_email")&&(this._hashedEmail=e.hashed_email),Object.prototype.hasOwnProperty.call(e,"phone")&&(this._phone=e.phone),Object.prototype.hasOwnProperty.call(e,"subscribed_newsletters_variants")&&(this._subscribedNewslettersVariants=e.subscribed_newsletters_variants),this._rawData=e},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"email",{get:function(){return this._email},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hashedEmail",{get:function(){return this._hashedEmail},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"phone",{get:function(){return this._phone},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subscribedNewsletters",{get:function(){return null===this._subscribedNewslettersVariants?[]:Object.keys(this._subscribedNewslettersVariants)},enumerable:!1,configurable:!0}),e.prototype.isSubscribedToNewsletter=function(e){return null!==this._subscribedNewslettersVariants&&Object.prototype.hasOwnProperty.call(this._subscribedNewslettersVariants,e)},e.prototype.isSubscribedToNewsletterVariantId=function(e,t){return null!==this._subscribedNewslettersVariants&&Object.prototype.hasOwnProperty.call(this._subscribedNewslettersVariants,e)&&Object.prototype.hasOwnProperty.call(this._subscribedNewslettersVariants[e],t)},Object.defineProperty(e.prototype,"rawData",{get:function(){return this._rawData},enumerable:!1,configurable:!0}),e}(),N=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),j=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="InvalidCacheItemError",i}return N(t,e),t}(o),x=function(){function e(e,t,n,i){this._fresh=null,this._key=e,this._value=t,this._createdAt=i||new Date,this._expireAt=n}return Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdAtTimestamp",{get:function(){return Math.round(this._createdAt.getTime()/1e3)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expireAt",{get:function(){return this._expireAt},set:function(e){this._expireAt=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fresh",{set:function(e){this._fresh=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ttl",{get:function(){var e=new Date,t=Math.floor((this.expireAt.getTime()-e.getTime())/1e3);return 0>t?0:t},enumerable:!1,configurable:!0}),e.createFromJson=function(t,n){var i;try{i=f.parseJson(n)}catch(e){throw new j("JSON decode failed with error: "+e.message)}if(!Object.prototype.hasOwnProperty.call(i,"value")||!Object.prototype.hasOwnProperty.call(i,"ttl")||!Object.prototype.hasOwnProperty.call(i,"created_at"))throw new j('Cache item "'+n+"\" doesn't have expected structure.");if(!f.isInt(i.created_at)||!f.isInt(i.ttl))throw new j('Cache item "'+n+'" is invalid.');return new e(t,i.value,new Date(1e3*i.ttl),new Date(1e3*i.created_at))},e.prototype.toJson=function(){var e={created_at:this.createdAtTimestamp,ttl:Math.round(this._expireAt.getTime()/1e3),value:this._value};return JSON.stringify(e)},e.prototype.isFresh=function(){return null!==this._fresh?this._fresh:this.ttl>0},e}(),F=function(){function e(){this.logger=null}return e.prototype.setLogger=function(e){this.logger=e},e.prototype.getCacheItem=function(e,t){void 0===t&&(t=null),this.log('getCacheItem("'+e+'")');try{var n=localStorage.getItem(e);if(!n)return this.log('Cache item "'+e+'" not found in localStorage.'),t;var i=x.createFromJson(e,n);return this.log("cacheItem loaded",x),i}catch(n){return this.log('Loading cache item "'+e+'" failed with error: '+n.message),localStorage.removeItem(e),t}},e.prototype.setCacheItem=function(e){this.log("setCacheItem()",e),localStorage.setItem(e.key,e.toJson())},e.prototype.get=function(e,t){void 0===t&&(t=null),this.log('get("'+e+'")');var n=this.getCacheItem(e,t);return null===n?t:n.isFresh()?n.value:(this.log('cache with key "'+e+'" is not fresh'),t)},e.prototype.set=function(e,t,n){this.log('set("'+e+'", ttl: '+n+")",t);var i=new Date,r=new x(e,t,new Date(i.getTime()+1e3*n),i);this.setCacheItem(r)},e.prototype.log=function(e,t){null!==this.logger&&this.logger.debug("LocalStorageCache",e,t)},e}(),z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),M=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="IframeError",i}return z(t,e),t}(o),B=n(2),H=function(){function e(e,t){this._response=null,this._messageId=e,this._resolvePromise=t}return Object.defineProperty(e.prototype,"messageId",{get:function(){return this._messageId},enumerable:!1,configurable:!0}),e.prototype.resolveResponse=function(e){this._response=e,this._resolvePromise(e)},Object.defineProperty(e.prototype,"response",{get:function(){return this._response},enumerable:!1,configurable:!0}),e}(),W=function(){function e(e){this.iframeIdentity="",this.iframeElement=null,this.logger=null,this.iframeUrl=e,this.messages=new Map}return e.prototype.setLogger=function(e){this.logger=e},e.prototype.destroy=function(){this.messages=new Map,this.iframeElement&&this.iframeElement.parentNode&&this.iframeElement.parentNode.removeChild(this.iframeElement),this.iframeElement=null},e.prototype.lazyDestroy=function(){var e=this;0===this.messages.size&&setTimeout((function(){e.destroy()}),600)},e.prototype.sendMessage=function(e,t){var n=this;return this.log('sendMessage("'+e+'", '+t+")"),Object(B.timeout)(new Promise((function(t,i){n.initIframe().then((function(){if(n.log("iframe ready"),!n.iframeElement||!n.iframeElement.contentWindow)throw new M("Invalid state - the iframe should be initialized.");n.log('sending message: "'+e+'"');var i=new H(e,t);n.messages.set(e,i),n.iframeElement.contentWindow.postMessage(e,n.getIframeIdentity()),n.log("waiting for response")})).catch((function(e){n.log("rejected",e),i(e)}))})),t)},e.prototype.getIframeIdentity=function(){if(this.iframeIdentity)return this.iframeIdentity;var e=this.iframeUrl.match(/https?:\/\/[^/]+/);return null!==e&&(this.iframeIdentity=e[0]),this.iframeIdentity},e.prototype.initIframe=function(){var e=this;return this.log("initIframe()"),new Promise((function(t,n){if(null===e.iframeElement)try{e.log("Creating iframe in DOM with url: "+e.iframeUrl),e.iframeElement=document.createElement("iframe"),e.iframeElement.setAttribute("style","width:0; height:0; border:0; border:none; visibility: hidden; display: none;"),e.iframeElement.setAttribute("src",e.iframeUrl),e.iframeElement.addEventListener("load",(function(){t()})),window.addEventListener("message",e.onReceiveMessage.bind(e),!1),document.body.appendChild(e.iframeElement),e.log("Creating iframe in DOM done")}catch(t){e.log("Creating iframe in DOM failed with message: "+t.message),n(t)}else t()}))},e.prototype.onReceiveMessage=function(e){if(this.log("onReceiveMessage()",e),e.origin===this.getIframeIdentity()){var t,n=e.data.indexOf(":"),i=null;n<=0?t=e.data:(t=e.data.substr(0,n),i=e.data.substr(n+1));var r=this.messages.get(t);r?(this.messages.delete(t),r.resolveResponse(i),this.log('messageId resolved with data "'+i+'"')):this.log('Unknown messageId "'+t)}else this.log('Message ignored, unknown identity "'+e.origin+'", "'+this.getIframeIdentity()+'" expected')},e.prototype.log=function(e,t){null!==this.logger&&this.logger.debug("SharedLocalStorage",e,t)},e}(),G=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),q=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.stack=new Error(t[0]).stack,i.name="UserDataLoadFailedError",i}return G(t,e),t}(d),V=function(){function e(e){this.reloadPromiseStatus="init",this.reloadPromise=null,this.logger=null,this.sharedLs=null,this.localCacheItem=null,this.sharedCacheItem=null,this.user=null,this.config=e,this.lsCache=new F}return e.prototype.setLogger=function(e){this.logger=e},e.prototype.loadUserData=function(e){var t=this;if(this.log("loadUserData()"),this.user=e,!this.config.userDataFetchUrl)throw new o('To load user data, please, specify "userDataFetchUrl" in config.');return this.reloadPromise&&this.isReloadPromiseUsable()?this.reloadPromise:new Promise((function(e,n){t.load(e,n)}))},e.prototype.reloadUserData=function(e){var t=this;return this.log("reloadUserData()"),this.user=e,this.localCacheItem=null,this.sharedCacheItem=null,new Promise((function(e,n){t.requestUserData(e,n)}))},e.prototype.isReloadPromiseUsable=function(){return"updating"===this.reloadPromiseStatus||"success"===this.reloadPromiseStatus&&!(!this.localCacheItem||!this.localCacheItem.isFresh())},e.prototype.load=function(e,t){var n=null;if(this.localCacheItem=this.lsCache.getCacheItem("sme_cl_user",null),this.localCacheItem&&this.localCacheItem.value&&this.isCacheItemFresh(this.localCacheItem)){var i=this.localCacheItem.value;if(this.log("Data in local storage found",i),n=U.createFromRawData(i),this.isValid(n))return this.log("Data in local storage accepted, resolved",i),this.pushToSharedLocalStorage(this.localCacheItem),void e(n);this.log("Data in local storage invalid")}else this.log("No fresh data found in local storage");this.config.sharedIframeUrl?this.processSharedIframeCache(e,t):this.requestUserData(e,t)},e.prototype.processSharedIframeCache=function(e,t){var n=this;this.log("try to find data in shared storage"),this.getSharedLs().sendMessage("sme_cl.getUserData",1e3).then((function(i){try{if(n.sharedCacheItem=x.createFromJson("sme_cl_user",i),n.isCacheItemFresh(n.sharedCacheItem)){var r=U.createFromRawData(n.sharedCacheItem.value);if(n.isValid(r))return n.log("Data from shared local storage accepted, resolved",n.sharedCacheItem.value),n.localCacheItem=n.sharedCacheItem,n.lsCache.setCacheItem(n.sharedCacheItem),void e(r)}}catch(i){return n.log("Creating cache item from shared ls data failed with error: "+i.message),void n.requestUserData(e,t)}})).catch((function(i){n.log("shared local storage failed with error: "+i.message),n.requestUserData(e,t)}))},e.prototype.requestUserData=function(e,t){var n=this;this.reloadPromiseStatus="updating",this.reloadPromise=this.fetchFromServer(),this.reloadPromise.then((function(t){n.reloadPromiseStatus="success",n.localCacheItem=new x("sme_cl_user",t.rawData,n.getCurrentExpireAt(1800)),n.lsCache.setCacheItem(n.localCacheItem),n.pushToSharedLocalStorage(n.localCacheItem),e(t)})).catch((function(i){if(n.reloadPromiseStatus="error",n.sharedCacheItem){var r=U.createFromRawData(n.sharedCacheItem.value);if(n.isValid(r))return n.log("Outdated data from shared local storage accepted, resolved",r),n.sharedCacheItem.expireAt=n.getCurrentExpireAt(3600),n.localCacheItem=n.sharedCacheItem,n.lsCache.setCacheItem(n.sharedCacheItem),n.pushToSharedLocalStorage(n.sharedCacheItem),void e(r)}if(n.localCacheItem&&(r=U.createFromRawData(n.localCacheItem.value),n.isValid(r)))return n.log("Outdated data from local storage accepted, resolved",r),n.localCacheItem.expireAt=n.getCurrentExpireAt(3600),n.lsCache.setCacheItem(n.localCacheItem),n.pushToSharedLocalStorage(n.localCacheItem),void e(r);t(new q('Loading UserData failed with error "'+i.message+'".'))}))},e.prototype.isValid=function(e){return e.id?!this.user||this.user.id===e.id||(this.log('Data in local storage belongs to user "'+e.id+'", but currently logged in user is "'+this.user.id+'".'),!1):(this.log("Data in local storage are invalid"),!1)},e.prototype.getSharedLs=function(){if(!this.config.sharedIframeUrl)throw new o("Invalid state, sharedIframeUrl should be defined in config");return null===this.sharedLs&&(this.sharedLs=new W(this.config.sharedIframeUrl)),this.logger&&this.sharedLs.setLogger(this.logger),this.sharedLs},e.prototype.pushToSharedLocalStorage=function(e){var t=this;this.config.sharedIframeUrl&&this.getSharedLs().sendMessage("sme_cl.setUserData:"+e.toJson(),2e3).then((function(){t.log("sharedLs success")})).catch((function(){t.log("sharedLs error")}))},e.prototype.getCurrentExpireAt=function(e){var t=new Date;return new Date(t.getTime()+1e3*e)},e.prototype.fetchFromServer=function(){var e=this;if(this.log("fetchFromServer()"),!this.config.userDataFetchUrl)throw new o('Invalid state. "userDataFetchUrl" should be configured.');return new Promise((function(t,n){if(!e.user)throw new o("Invalid state. Unknown user.");if(!e.config.userDataFetchUrl)throw new o('Invalid state. "userDataFetchUrl" should be configured.');try{var i=new XMLHttpRequest;i.ontimeout=function(){return e.onTimeout(n)},i.onerror=function(){return e.onError(i,n)},i.onload=function(){200===i.status?e.onSuccess(i,t,n):e.onError(i,n)};var r=e.config.userDataFetchUrl.replace("{userId}",e.user.id.toString());i.open("GET",r,!0),i.timeout=7e3,i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-Type","application/json"),i.withCredentials=!0,i.send(),e.log("Ajax request to "+r)}catch(e){n(e)}}))},e.prototype.onSuccess=function(e,t,n){this.log("Ajax success",e);var i=e.responseText;if(i){var r=U.createFromRawData(this.parseJson(i));if(this.isValid(r))return this.log("Data from ajax accepted, resolved",r),void t(r)}this.log("Invalid data in json response."),n(new q("Invalid response from server: "+i))},e.prototype.onTimeout=function(e){this.log("Ajax failed with timeout."),e(new q("HTTP API timeout"))},e.prototype.onError=function(e,t){this.log("Ajax error. Response status code: "+e.status),t(new q("HTTP API Error"))},e.prototype.parseJson=function(e){try{return f.parseJson(e)}catch(e){throw new q("JSON parsing failed with error: "+e.message)}},e.prototype.isCacheItemFresh=function(e){if(!e.isFresh())return!1;if(this.user){if(this.isChangeCookieAccepted(e,"pwall_change"))return e.fresh=!1,!1;if(this.isChangeCookieAccepted(e,"sme_nl_change"))return e.fresh=!1,!1}return!0},e.prototype.isChangeCookieAccepted=function(e,t){if(!this.user)return!1;var n=T.get(t);if(n)try{var i=n.split("_"),r=f.toInt(i[0]),o=f.toInt(i[1]);if(o&&this.user.id===r&&e.createdAtTimestamp<=o+10)return this.log('Cookie "'+t+'" accepted. User data changed, should be refreshed.'),!0}catch(e){this.log('Error occurred during resolving value of "'+t+'" cookie: '+e.message)}return!1},e.prototype.log=function(e,t){null!==this.logger&&this.logger.debug("UserDataLoader",e,t)},e}(),J=function(){function e(e){this.loader=null,this.logger=null,this.userPayload=null,this.user=null,this.userDataLoader=null,this.config=new D(e),this.log("Central instance created",this.config),this.config.refreshOnFocus&&(this.log("add window.onFocus() listener"),window.addEventListener("focus",this.onWindowFocus.bind(this)))}return e.prototype.setLogger=function(e){this.logger=e},e.prototype.getUser=function(){var e=this;return this.log("getUser()"),new Promise((function(t,n){null!==e.user&&null!==e.userPayload&&e.userPayload.isFresh()&&(e.log("resolved from local cache"),t(e.user)),e.log("calling loader"),e.getLoader().loadToken().then((function(n){if(e.loadUserFromUserPayload(n),null===e.user)throw new o("Unexpected state - User should be converted from userPayload");e.log("resolved",e.user),e.planToRefreshToken(),t(e.user)})).catch((function(t){e.log("rejected",t),n(t)}))}))},e.prototype.refreshUser=function(){var e=this;return this.log("refreshUser()"),new Promise((function(t,n){e.getLoader().refreshToken().then((function(n){if(e.log("resolved",n),e.loadUserFromUserPayload(n),null===e.user)throw new o("Unexpected state - User should be converted from userPayload");e.log("created user",e.user),e.planToRefreshToken(),t(e.user)})).catch((function(t){e.log("rejected",t),n(t)}))}))},e.prototype.getUserData=function(){var e=this.getUserDataLoader();if(!this.user)throw new o("No user found. Call `getUser()` first.");return e.loadUserData(this.user)},e.prototype.refreshUserData=function(){var e=this.getUserDataLoader();if(!this.user)throw new o("No user found. Call `getUser()` first.");return e.reloadUserData(this.user)},e.prototype.onWindowFocus=function(){var e=this;this.log("onWindowFocus()"),this.config.refreshOnFocus?null!==this.userPayload?this.userPayload.isFresh()?this.log("userPayload in cache is fresh",this.userPayload):(this.log("calling loader"),this.getLoader().loadToken().then((function(t){if(e.loadUserFromUserPayload(t),null===e.user)throw new o("Unexpected state - User should be converted from userPayload");e.log("user loaded successfully",e.user),e.planToRefreshToken()})).catch((function(t){e.log("error loading user",t)}))):this.log("no userPayload, onWindowFocus() ignored",this.userPayload):this.log("refreshBeforeExpire disabled, onWindowFocus() ignored")},e.prototype.clearCache=function(){this.log("clearCache()"),this.user=null,this.userPayload=null,this.getLoader().clearCache()},e.prototype.getLoader=function(){return null!==this.loader?this.loader:this.config.shareTokenLoader&&Object.prototype.hasOwnProperty.call(window,"_smeCentralTokenLoader_v0_5")&&window._smeCentralTokenLoader_v0_5?(this.log("Used tokenLoader from other Central instance"),this.loader=window._smeCentralTokenLoader_v0_5,this.loader):(this.log("Creating instance of TokenLoader"),this.loader=new P(this.config),null!==this.logger&&this.loader.setLogger(this.logger),this.config.shareTokenLoader&&(window._smeCentralTokenLoader_v0_5=this.loader,this.log("Publish TokenLoader to be used by other Central lib instances")),this.loader)},e.prototype.getUserDataLoader=function(){return this.userDataLoader||(this.userDataLoader=new V(this.config)),this.userDataLoader},e.prototype.log=function(e,t){null!==this.logger&&this.logger.debug("Main",e,t)},e.prototype.planToRefreshToken=function(){var e=this;if(this.log("planToRefreshToken()"),this.config.refreshBeforeExpire)if(null!==this.userPayload){var t,n=this.userPayload.ttl;this.log("token ttl: "+n),n>this.config.refreshTokenPeriodBeforeExpire?(t=n-this.config.refreshTokenPeriodBeforeExpire,this.log("token will expire in the future, refresh it after "+t+" seconds")):(this.log("token will expire soon, refresh it ASAP"),t=0),this.getLoader().refreshTokenAfter(t).then((function(t){e.loadUserFromUserPayload(t),e.planToRefreshToken(),e.log("resolved",e.user)}))}else this.log("no userPayload, ignored",this.userPayload);else this.log("refreshBeforeExpire disabled, planToRefreshToken() ignored")},e.prototype.loadUserFromUserPayload=function(e){this.userPayload=e,this.user=new l(f.toInt(this.userPayload.subject),this.userPayload.email,this.userPayload.confirmed,this.userPayload.postInbox,this.userPayload.subscriptionRoles)},e}(),Y=function(){function e(e){e||(e="Central_"+Math.random().toString(36).substr(2,5)),this.instanceId=e}return e.prototype.debug=function(e,t,n){this.log("debug",e,t,n)},e.prototype.log=function(e,t,n,i){if(n="["+this.instanceId+"] [Sme/Central/"+t+"] "+n,i)switch(e){case"error":console.error(n,i);break;case"warn":console.warn(n,i);break;case"info":console.info(n,i);break;case"debug":default:console.debug(n,i)}else switch(e){case"error":console.error(n);break;case"warn":console.warn(n);break;case"info":console.info(n);break;case"debug":default:console.debug(n)}},e}()}])},Wr5T:function(e,t){!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=window.document,t=[];i.prototype.THROTTLE_TIMEOUT=100,i.prototype.POLL_INTERVAL=null,i.prototype.USE_MUTATION_OBSERVER=!0,i.prototype.observe=function(e){if(!this._observationTargets.some((function(t){return t.element==e}))){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},i.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter((function(t){return t.element!=e})),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},i.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},i.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},i.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter((function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]}))},i.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map((function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}}));return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},i.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(r(window,"resize",this._checkForIntersections,!0),r(e,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},i.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,o(window,"resize",this._checkForIntersections,!0),o(e,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},i.prototype._checkForIntersections=function(){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(i){var r=i.element,o=a(r),s=this._rootContainsTarget(r),l=i.entry,u=e&&s&&this._computeTargetAndRootIntersection(r,t),d=i.entry=new n({time:window.performance&&performance.now&&performance.now(),target:r,boundingClientRect:o,rootBounds:t,intersectionRect:u});l?e&&s?this._hasCrossedThreshold(l,d)&&this._queuedEntries.push(d):l&&l.isIntersecting&&this._queuedEntries.push(d):this._queuedEntries.push(d)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},i.prototype._computeTargetAndRootIntersection=function(t,n){if("none"!=window.getComputedStyle(t).display){for(var i,r,o,s,u,d,c,h,f=a(t),p=l(t),g=!1;!g;){var v=null,y=1==p.nodeType?window.getComputedStyle(p):{};if("none"==y.display)return;if(p==this.root||p==e?(g=!0,v=n):p!=e.body&&p!=e.documentElement&&"visible"!=y.overflow&&(v=a(p)),v&&(i=v,r=f,o=void 0,s=void 0,u=void 0,d=void 0,c=void 0,h=void 0,o=Math.max(i.top,r.top),s=Math.min(i.bottom,r.bottom),u=Math.max(i.left,r.left),d=Math.min(i.right,r.right),h=s-o,!(f=(c=d-u)>=0&&h>=0&&{top:o,bottom:s,left:u,right:d,width:c,height:h})))break;p=l(p)}return f}},i.prototype._getRootRect=function(){var t;if(this.root)t=a(this.root);else{var n=e.documentElement,i=e.body;t={top:0,left:0,right:n.clientWidth||i.clientWidth,width:n.clientWidth||i.clientWidth,bottom:n.clientHeight||i.clientHeight,height:n.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(t)},i.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map((function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100})),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},i.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,i=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==i)for(var r=0;r<this.thresholds.length;r++){var o=this.thresholds[r];if(o==n||o==i||o<n!=o<i)return!0}},i.prototype._rootIsInDom=function(){return!this.root||s(e,this.root)},i.prototype._rootContainsTarget=function(t){return s(this.root||e,t)},i.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},i.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=i,window.IntersectionObserverEntry=n}function n(e){this.time=e.time,this.target=e.target,this.rootBounds=e.rootBounds,this.boundingClientRect=e.boundingClientRect,this.intersectionRect=e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,i=this.intersectionRect,r=i.width*i.height;this.intersectionRatio=n?Number((r/n).toFixed(4)):this.isIntersecting?1:0}function i(e,t){var n,i,r,o=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(o.root&&1!=o.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),i=this.THROTTLE_TIMEOUT,r=null,function(){r||(r=setTimeout((function(){n(),r=null}),i))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(o.rootMargin),this.thresholds=this._initThresholds(o.threshold),this.root=o.root||null,this.rootMargin=this._rootMarginValues.map((function(e){return e.value+e.unit})).join(" ")}function r(e,t,n,i){"function"==typeof e.addEventListener?e.addEventListener(t,n,i||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function o(e,t,n,i){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,i||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function a(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function s(e,t){for(var n=t;n;){if(n==e)return!0;n=l(n)}return!1}function l(e){var t=e.parentNode;return t&&11==t.nodeType&&t.host?t.host:t&&t.assignedSlot?t.assignedSlot.parentNode:t}}()},bUFL:function(e,t,n){"use strict";n.r(t);n("Wr5T");var i=n("tL+y");function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.attribute="",this.namespace="",this.slotKey="",this.debugKey="",this.enabled=!1,this.valueGlue="/"}var t,n,i;return t=e,(n=[{key:"setData",value:function(e){this.attribute=e.attribute,this.namespace=e.namespace,this.slotKey=e.slotKey,this.debugKey=e.debugKey,this.enabled=!0}},{key:"attachDebugMarker",value:function(e,t){if(this.enabled&&t){var n=this.getSlotEntity(t);n&&e.setAttribute(this.getDebugAttribute(),this.getDebugValue(n))}}},{key:"getDebugAttribute",value:function(){return this.attribute}},{key:"getDebugValue",value:function(e){return"".concat(this.namespace).concat(this.valueGlue).concat(this.debugKey).concat(this.valueGlue).concat(e)}},{key:"getSlotEntity",value:function(e){var t,n=e.getAttribute(this.attribute);return n?n.indexOf(this.valueGlue)<1?null:null!==(t=n.split(this.valueGlue).pop())&&void 0!==t?t:null:null}}])&&r(t.prototype,n),i&&r(t,i),e}());function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ignoredProperties=["divElement","ref","label","positionName","observer","maxWidth","forceReload","forceReloadPerformed","trackPerformance","observed","lazyObserved","fluidLabel","signalModifier","targeting"],this.priorityProperties=["provider","position"],this.enabled=!1}var t,n,i;return t=e,i=[{key:"isObject",value:function(e){return null!==e&&("function"==typeof e||"object"===a(e))}}],(n=[{key:"enable",value:function(e){this.enabled=!0;var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(t)}},{key:"update",value:function(e,t){if(this.enabled){var n=document.getElementById("".concat(e.divId,"-debug-info-detail"));null!==n?this.updateContent(e,n,t):this.create(e)}}},{key:"create",value:function(e){if(this.enabled&&null!==e.divElement){var t=document.createElement("div");t.id="".concat(e.divId,"-debug-info-detail"),t.classList.add("ad-manager-debug-info"),t.classList.add("ad-manager-debug-info-".concat(e.provider.toString())),t.style.display="none",o.attachDebugMarker(t,e.divElement),this.updateContent(e,t);var n=e.divElement.parentElement;if(null===n)throw new Error('parentElement of adSlot divElement with id="'.concat(e.divId,'" should not be null'));if(Element.prototype.hasOwnProperty("prepend"))n.prepend(t);else{var i=document.createDocumentFragment();i.appendChild(t),n.insertBefore(i,n.firstChild)}}}},{key:"updateContent",value:function(e,t,n){var i=this;if(n){var r=t.querySelector(".js-ad-manager-debug-info-detail-".concat(n));return null!==r?void(r.innerHTML=this.generatePropertyHtml(n,e[n],!1)):void(t.innerHTML=t.innerHTML+this.generatePropertyHtml(n,e[n],!0))}var o=[];Object.keys(e).forEach((function(t){if(null===e[t])return"";i.priorityProperties.includes(t)?o.unshift(i.generatePropertyHtml(t,e[t],!0)):o.push(i.generatePropertyHtml(t,e[t],!0))}),this),t.innerHTML=o.join("")}},{key:"generatePropertyHtml",value:function(t,n,i){if(this.ignoredProperties.includes(t))return"";if(e.isObject(n)){var r=n;n="function"==typeof r.toString?r.toString():JSON.stringify(r)}var o="<strong>".concat(t,"</strong>: ").concat(n);return i?'<span class="js-ad-manager-debug-info-detail-'.concat(t,'">').concat(o,"</span>"):o}}])&&s(t.prototype,n),i&&s(t,i),e}());function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.OBSERVER_THRESHOLD=.5,this.STOP_REFRESH_FILLED_COUNT=20,this.STOP_REFRESH_FILLED_COUNT_DEBUG=3,this.observer=null,this.observingAdSlots=new Map,this.visibleAdSlots=new Set,this.refreshIntervalId=0,this.isSupportedInClient()?"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.load.bind(this)):this.load():e.debug("EXITING - IntersectionObserver is not supported in current browser")}var t,n,r;return t=e,r=[{key:"debug",value:function(e,t){i.a.log("AdRefresher",e,t)}}],(n=[{key:"isSupportedInClient",value:function(){return"function"==typeof window.IntersectionObserver}},{key:"observe",value:function(t){if(e.debug("observe()",t),this.observingAdSlots.has(t.divId))e.debug("observer already appended",t);else if(this.observingAdSlots.set(t.divId,t),null!==this.observer){if(null===t.divElement)throw new Error('divElement for position "'.concat(t.positionName,'" should not be null'));this.observer.observe(t.divElement),this.startInterval()}}},{key:"unobserve",value:function(t){e.debug("unobserve()",t),this.observingAdSlots.delete(t.divId),null!==this.observer&&null!==t.divElement&&this.observer.unobserve(t.divElement),this.visibleAdSlots.delete(t)}},{key:"onIntersection",value:function(t){var n=this;e.debug("onIntersection()"),t.forEach((function(t){var i=t.target.getAttribute("id");if(e.debug("onIntersection: divId="+i),n.observingAdSlots.has(i)){var r=n.observingAdSlots.get(i);e.debug("onIntersection: adSlot",r),e.debug("intersection ratio",t.intersectionRatio),t.intersectionRatio>=n.OBSERVER_THRESHOLD?r.loadInitialized?(e.debug("onIntersection: adding adSlot to visible ads",r),n.visibleAdSlots.add(r)):e.debug("onIntersection: NOT adding adSlot to visible ads because it is visible but not yet loaded",r):(e.debug("onIntersection: removing adSlot from visible ads",r),n.visibleAdSlots.delete(r))}else e.debug("onIntersection: cant find adSlot with divId: "+i)}))}},{key:"load",value:function(){var t=this;e.debug("load()"),e.debug("initializing intersection observer"),this.observer=new IntersectionObserver(this.onIntersection.bind(this),{root:null,rootMargin:"0px",threshold:this.OBSERVER_THRESHOLD}),this.observingAdSlots.forEach((function(n){e.debug("observing adSlot in IntersectionObserver",n),null!==t.observer&&t.observer.observe(n.divElement)})),this.startInterval(),document.addEventListener("visibilitychange",this.onVisibilityChange.bind(this),!1)}},{key:"onVisibilityChange",value:function(){e.debug("onVisibilityChange()"),document.hidden?(e.debug("document is not visible"),this.stopInterval()):(e.debug("document is visible"),this.startInterval())}},{key:"toggleState",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e.debug("explicit state toggle"),t)return this.stopInterval(),void e.debug("refresh paused");this.startInterval(),e.debug("refresh resumed")}},{key:"onRefreshInterval",value:function(){var t=this;e.debug("onRefreshInterval()");var n=this.getStopRefreshFilledCount();this.visibleAdSlots.forEach((function(i){return i.totalViewTime++,e.debug("+1 in adSlot totalViewTime, now:"+i.totalViewTime,i),0===i.refreshAfter?(e.debug("detected disabled refreshing in adSlot, calling unobserve",i),void t.unobserve(i)):n<=i.filledCount?(e.debug('Slot "'.concat(i.positionName,'" reached maximum filled count (').concat(n,"). Refresh STOP.")),t.unobserve(i),i.refreshAfter=0,void l.update(i)):(i.totalViewTime>=i.refreshAfter&&i.refreshAfter>0&&(e.debug("refreshing adSlot"),i.provider.refresh(i),i.totalViewTime=0),void l.update(i,"totalViewTime"))}))}},{key:"startInterval",value:function(){e.debug("startInterval()"),0!==this.observingAdSlots.size?null!==this.observer?0===this.refreshIntervalId&&(e.debug("activating interval"),this.refreshIntervalId=window.setInterval(this.onRefreshInterval.bind(this),1e3)):e.debug("not starting interval because tobserver is not initialized yet"):e.debug("not starting interval because there is no ad to observe")}},{key:"stopInterval",value:function(){e.debug("stopInterval()"),0!==this.refreshIntervalId&&(e.debug("stopped interval"),window.clearInterval(this.refreshIntervalId),this.refreshIntervalId=0)}},{key:"getStopRefreshFilledCount",value:function(){return 0<window.location.hash.indexOf("advmngrDbgAdRfrshrLimt")?this.STOP_REFRESH_FILLED_COUNT_DEBUG:this.STOP_REFRESH_FILLED_COUNT}}])&&u(t.prototype,n),r&&u(t,r),e}();function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.CLASS_CENTER_WRAPPER_1200="admngr-wide1200",this.CLASS_WRAPPER_WIDTH_1200="admngr-wdth1200",this.DEFAULT_PAGE_CONTENT_WIDTH=1e3,this.LARGE_CONTENT_WIDTH=1200,this.contentWidth=this.DEFAULT_PAGE_CONTENT_WIDTH}var t,n,i;return t=e,(n=[{key:"setContentWidth",value:function(e){this.contentWidth=e}},{key:"getContentWidth",value:function(){return this.contentWidth}}])&&c(t.prototype,n),i&&c(t,i),e}());function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.PLACEHOLDER_HEIGHT_LOCK_REMOVE_TIMEOUT=200}var t,n,r;return t=e,r=[{key:"hasOverflow",value:function(e){return e.classList.contains("admngr-overflow-hidden")}},{key:"isHidden",value:function(e){return e.classList.contains("admngr-hidden")}},{key:"debug",value:function(e,t){i.a.log("ElementManipulator",e,t)}}],(n=[{key:"setOverflow",value:function(t){e.hasOverflow(t)||(t.classList.add("admngr-overflow-hidden"),e.debug("overflow hidden applied",t))}},{key:"removeOverflow",value:function(t){e.hasOverflow(t)&&(t.classList.remove("admngr-overflow-hidden"),e.debug("overflow hidden removed",t))}},{key:"hide",value:function(t){e.isHidden(t)||(t.classList.add("admngr-hidden"),e.debug("hide element",t))}},{key:"show",value:function(t){e.isHidden(t)&&(t.classList.remove("admngr-hidden"),e.debug("show element",t))}},{key:"setEmptySize",value:function(t){t.style.width="1px",t.style.height="1px",e.debug("setting 1x1 px size",t)}},{key:"removeEmptySize",value:function(t){t.style.width="",t.style.height="",e.debug("removing slot width and height",t)}},{key:"attachDisabledStateToBody",value:function(){var e=document.getElementsByTagName("body");if(0!==e.length){var t=e[0];t.classList.contains("admngr-disabled")||t.classList.add("admngr-disabled")}}},{key:"centerWrapperBySize",value:function(e,t){if(!(null===e||h.getContentWidth()>=t||null===(null==e?void 0:e.parentElement))){var n=e.parentElement;h.LARGE_CONTENT_WIDTH!==t?(n.style.maxWidth="".concat(t,"px"),n.style.marginLeft="auto",n.style.marginRight="auto"):n.classList.add(h.CLASS_CENTER_WRAPPER_1200)}}},{key:"appendDivElement",value:function(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return void 0===t?(e.debug("/appendDivElement no parent or #id already present",[t,i]),null):i&&(n=document.getElementById(i))?n:(n=document.createElement("div"),i&&(n.id=i),r&&n.setAttribute("class",r),t.appendChild(n),n)}},{key:"setIframeBlockStyle",value:function(e){if(null!==e){var t=e.querySelector("iframe");t&&(t.style.display="block")}}},{key:"removePlaceholderHeightLock",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(null!==e){var n=function(){e.classList.contains("advm-plchlck")&&e.classList.remove("advm-plchlck"),W.removeGateHeightLockMark(e);var t=e.parentElement;null!==t&&t.querySelectorAll(".".concat("advm-plchlck")).forEach((function(e){e.classList.remove("advm-plchlck");var t=e.querySelector(".".concat("advm-plchld"));t&&t.remove()}))};t?setTimeout((function(){n()}),t):n()}}},{key:"setHeightInPx",value:function(e,t){e.style.height="".concat(t,"px")}}])&&f(t.prototype,n),r&&f(t,r),e}());function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var v=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n}var t,n,i;return t=e,(n=[{key:"isSameAs",value:function(e){return!!e&&this.width===e.width&&this.width===e.height}},{key:"toString",value:function(){return this.width+"x"+this.height}}])&&g(t.prototype,n),i&&g(t,i),e}();function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.labelElement=null,this.hidden=!0,this.hiddenClass="admngr-hidden",this.initialized=!1,this.onClickDestroyAdSlotEnabled=!1,this.adSlot=t}var t,n,r;return t=e,(n=[{key:"isHidden",value:function(){return this.ensureInitialization(),this.hidden}},{key:"show",value:function(){this.ensureInitialization(),null!==this.labelElement?!1!==this.hidden?(null!==this.adSlot.size&&0<this.adSlot.size.width&&1!==this.adSlot.size.width&&(this.labelElement.style.maxWidth=this.adSlot.size.width+"px"),this.labelElement.classList.remove(this.hiddenClass),this.hidden=!1):this.debug("labelElement is already visible",this.adSlot):this.debug("labelElement is null",this.adSlot)}},{key:"hide",value:function(){this.ensureInitialization(),null!==this.labelElement&&!0!==this.isHidden()&&(this.labelElement.classList.add(this.hiddenClass),this.hidden=!0)}},{key:"setOnClickDestroyAdSlotEnabled",value:function(e){this.debug("setOnClickDestroyAdSlotEnabled",e),this.onClickDestroyAdSlotEnabled=e}},{key:"reset",value:function(){this.initialized=!1,this.hidden=!0}},{key:"ensureInitialization",value:function(){this.initialized||(this.labelElement=document.getElementById("".concat(this.adSlot.divId,"-promo-label")),null===this.labelElement||this.labelElement.classList.contains(this.hiddenClass)||(this.hidden=!1),this.initialized=!0,null!==this.labelElement&&this.labelElement.addEventListener("click",this.onClickEvent.bind(this)))}},{key:"onClickEvent",value:function(e){this.debug("click event occurred"),this.onClickDestroyAdSlotEnabled&&(e.preventDefault(),this.adSlot.provider.destroy(this.adSlot))}},{key:"debug",value:function(e,t){i.a.log("Label["+this.adSlot.divId+"]",e,t)}}])&&y(t.prototype,n),r&&y(t,r),e}();function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function E(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=E(this,S(t).apply(this,arguments))).trans={sk:{fluidLabel:"Inzercia"},en:{fluidLabel:"Advertisment"}},e}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,e),n=t,(i=[{key:"toggle",value:function(){(this.adSlot.isFluidContent||this.initialized)&&(this.ensureInitialization(),this.adSlot.isFluidContent?this.show():this.hide())}},{key:"toString",value:function(){return this.trans.sk.fluidLabel}},{key:"ensureInitialization",value:function(){if(!this.initialized||null===this.labelElement){var e=document.getElementById("".concat(this.adSlot.divId,"-promo-label"));if(null===this.labelElement&&null!==e){var t=document.createElement("span"),n=document.createTextNode(this.trans.sk.fluidLabel);t.classList.add("ad-manger-label-fluid"),t.classList.add(this.hiddenClass),t.appendChild(n),e.appendChild(t),this.labelElement=t,this.hidden=!0}this.initialized=!0}}}])&&w(n.prototype,i),r&&w(n,r),t}(b);function A(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var O=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.positionName=t}var t,n,i;return t=e,(n=[{key:"isFixedBottom",value:function(){return"fixed_bottom_resp"===this.positionName}},{key:"isSkyLeft",value:function(){return"big_1_left_side"===this.positionName}},{key:"isSkyRight",value:function(){return"big_1_right_side"===this.positionName}},{key:"isSkyPosition",value:function(){return this.isSkyLeft()||this.isSkyRight()}},{key:"toString",value:function(){return this.positionName}}])&&A(t.prototype,n),i&&A(t,i),e}();function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var T=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"convertToNumber",value:function(e,t){var n=parseInt(e,10);if(isNaN(n)){var i=C(e);throw new Error('Parameter "'.concat(t,'" contains "').concat(i,'" in value "').concat(e,'" that cannot be converted to integer.'))}return n}}],(n=[{key:"getAnyOrNUll",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.hasOwnProperty(t)?e[t]:n}},{key:"getNumber",value:function(t,n,i){if(!t.hasOwnProperty(n))return i;var r=t[n];return e.convertToNumber(r,n)}},{key:"getNumberOrNull",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t.hasOwnProperty(n))return i;var r=t[n];return null===r?r:e.convertToNumber(r,n)}},{key:"getString",value:function(e,t,n){if(!e.hasOwnProperty(t))return n;var i=e[t];if(null===i)throw new Error('Parameter "'.concat(t,'" contains null but string is required.'));var r=C(i);if("string"!==r)throw new Error('Parameter "'.concat(t,'" contains "').concat(r,'" but string is required.'));return i}},{key:"getStringOrNull",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e.hasOwnProperty(t))return n;var i=e[t];if(null===i)return i;var r=C(i);if("string"!==r)throw new Error('Parameter "'.concat(t,'" contains "').concat(r,'" but string is required.'));return i}},{key:"getBoolean",value:function(e,t,n){if(!e.hasOwnProperty(t))return n;var i=e[t],r=C(i);if("boolean"!==r)throw new Error('Parameter "'.concat(t,'" contains "').concat(r,'" but boolean is required.'));return i}},{key:"getObjectOrNull",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e.hasOwnProperty(t))return n;var i=e[t];if(null===i)return i;var r=C(i);if("object"!==r)throw new Error('Parameter "'.concat(t,'" contains "').concat(r,'" but object is required.'));return i}}])&&I(t.prototype,n),i&&I(t,i),e}());function P(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var R=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DEFAULT_AD_UNIT="/unknown/",this.adUnitPath=T.getString(t,"adUnitPath",this.DEFAULT_AD_UNIT),this.refreshAdUnitPath=T.getString(t,"refreshAdUnitPath",this.DEFAULT_AD_UNIT),this.sizes=T.getAnyOrNUll(t,"sizes")}var t,n,i;return t=e,(n=[{key:"toString",value:function(){return this.adUnitPath}}])&&P(t.prototype,n),i&&P(t,i),e}();var L=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.signal=null,this.action=null,this.applied=!1,t.hasOwnProperty("signal")&&t.hasOwnProperty("action")&&t.signal.hasOwnProperty("type")&&t.signal.hasOwnProperty("position")){var n=T.getString(t.signal,"type",""),i=T.getString(t.signal,"position","");if("renderPosition"!==n||!i)throw new Error('Unsupported Signal modifier type "'.concat(n,'" or position missing "').concat(i,'"'));this.signal={type:n,position:i},t.signal.hasOwnProperty("empty")&&(this.signal.empty=T.getBoolean(t.signal,"empty",!0)),t.action.hasOwnProperty("display")&&(this.action={display:T.getBoolean(t.action,"display",!0)})}};function D(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var U=function(){function e(t,n,i,r,o){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.layoutType="original",this.refreshAdUnitPath=null,this.originAdUnitPath=null,this.maxWidth=null,this.maxHeight=null,this.lazy=!1,this.lazyLoadOffset=null,this.lazyLoadOffsetFromTop=null,this.refreshAfter=null,this.originalRefreshTime=null,this.emptySlotRefreshTime=e.EMPTY_SLOT_REFRESH_TIME,this.useUserDisplayResolver=!1,this.showLabels=!1,this.forceReload=!1,this.forceReloadPerformed=!1,this.fallback=null,this.signalModifier=null,this.divElement=null,this.loadInitialized=!1,this.size=null,this.totalViewTime=0,this.isGateCapable=!1,this.isFluidContent=!1,this.isHiddenOnVisibleGate=!1,this.fluidLabel=null,this.trackPerformance=!1,this.startTime=null,!t)throw new Error("No provider given for AdSlot instance");this.provider=t,this.positionName=n,this.adUnitPath=i,this.sizes=r,this.divId=o,this.position=new O(this.positionName),this.label=new b(this)}var t,n,i;return t=e,i=[{key:"createFromDefinition",value:function(t){var n=new e(t.provider,t.positionName,t.adUnitPath,t.sizes,t.divId);return e.fillAdSlotFromDefinition(n,t),n}},{key:"fillAdSlotFromDefinition",value:function(e,t){e.layoutType=T.getString(t,"layoutType",e.layoutType),e.refreshAdUnitPath=T.getStringOrNull(t,"refreshAdUnitPath",e.refreshAdUnitPath),e.divElement=T.getAnyOrNUll(t,"divElement",e.divElement),e.sizes=T.getAnyOrNUll(t,"sizes",e.sizes),e.maxWidth=T.getNumberOrNull(t,"maxWidth",e.maxWidth),e.maxHeight=T.getNumberOrNull(t,"maxHeight",e.maxHeight),e.lazy=T.getBoolean(t,"lazy",e.lazy),e.lazyLoadOffset=T.getNumberOrNull(t,"lazyLoadOffset",e.lazyLoadOffset),e.lazyLoadOffsetFromTop=T.getNumberOrNull(t,"lazyLoadOffsetFromTop",e.lazyLoadOffsetFromTop),e.refreshAfter=T.getNumberOrNull(t,"refreshAfter",e.refreshAfter),e.useUserDisplayResolver=T.getBoolean(t,"useUserDisplayResolver",e.useUserDisplayResolver),e.showLabels=T.getBoolean(t,"showLabels",e.showLabels),e.parentSlotDivId=T.getStringOrNull(t,"parentSlotDivId",e.parentSlotDivId),e.targeting=T.getStringOrNull(t,"targeting",e.targeting),e.isGateCapable=T.getBoolean(t,"isGateCapable",e.isGateCapable),e.isFluidContent=T.getBoolean(t,"isFluidContent",e.isFluidContent),e.isHiddenOnVisibleGate=T.getBoolean(t,"isHiddenOnVisibleGate",e.isHiddenOnVisibleGate);var n=T.getObjectOrNull(t,"fallback",e.fallback);n&&(e.fallback=new R(n));var i=T.getObjectOrNull(t,"signalModifier",null);i&&(e.signalModifier=new L(i))}},{key:"getSizesWithoutGateSize",value:function(e){return e.filter((function(e){return!(Array.isArray(e)&&e.hasOwnProperty(0)&&1===e[0]&&e.hasOwnProperty(1)&&1===e[1])}))}}],(n=[{key:"applyDefinition",value:function(t){e.fillAdSlotFromDefinition(this,t)}},{key:"hasFluidSize",value:function(){return this.sizes&&this.sizes.hasOwnProperty(0)&&this.sizes[0]===e.FORMAT_NAME_FLUID}},{key:"getSizesWithoutGate",value:function(){return e.getSizesWithoutGateSize(this.sizes)}},{key:"getFallbackSizesWithoutGate",value:function(){return this.fallback?e.getSizesWithoutGateSize(this.fallback.sizes):[]}},{key:"detectFluidContent",value:function(e){this.isFluidContent=e&&0===e[0]&&0===e[1],this.isFluidContent&&null===this.fluidLabel&&(this.fluidLabel=new _(this))}},{key:"useEmptySlotRefreshTime",value:function(){var t;if(null!==this.refreshAfter&&null!==this.emptySlotRefreshTime&&0!==this.refreshAfter){var n=(null!==(t=this.consecutiveEmpty)&&void 0!==t?t:1)-1;n<0&&(n=0),0===n&&(this.originalRefreshTime=this.refreshAfter),this.refreshAfter=this.emptySlotRefreshTime+n*e.PROLONGED_EMPTY_REFRESH_MULTIPLIER}}},{key:"restoreRefreshTime",value:function(){null!==this.originalRefreshTime&&this.originalRefreshTime!==this.refreshAfter&&(this.refreshAfter=this.originalRefreshTime)}},{key:"updateSlotStatEmpty",value:function(){var e;this.consecutiveEmpty=(null!==(e=this.consecutiveEmpty)&&void 0!==e?e:0)+1}},{key:"updateSlotStatFilled",value:function(){var e;this.consecutiveEmpty=0,this.filledCount=(null!==(e=this.filledCount)&&void 0!==e?e:0)+1}}])&&D(t.prototype,n),i&&D(t,i),e}();function N(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}U.EMPTY_SLOT_REFRESH_TIME=15,U.PROLONGED_EMPTY_REFRESH_MULTIPLIER=5,U.FORMAT_NAME_GATE="gate",U.FORMAT_NAME_FLUID="fluid";var j=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.SLOT_SIZE_UNKNOWN_WIDTH=1,this.SLOT_SIZE_UNKNOWN_HEIGHT=1,this.SLOT_SIZE_NATIVE=[0,0],this.windowWidth=0,this.windowHeight=0,this.availableSideSizes=[[300,1050],[300,600],[300,250],[300,100],[250,360],[250,250],[240,400],[200,446],[200,200],[180,150],[160,90],[160,600],[125,125],[120,60],[120,90],[120,240],[120,600]],this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight}var t,n,i;return t=e,(n=[{key:"filterSlotSizes",value:function(e){e.sizes&&(this.filterMaxWidth(e),this.filterMaxHeight(e))}},{key:"flushSizes",value:function(e){e.sizes&&(e.sizes=[])}},{key:"sizeAvailable",value:function(e){return e.sizes!==[]}},{key:"moveLeftWrapper",value:function(e){var t=document.getElementsByClassName("admngr-sky-left")[0];if(t&&e.size&&t instanceof HTMLElement){var n=Math.abs(parseInt(t.style.left));(isNaN(n)||e.size.width!==n)&&t.setAttribute("style","left: -".concat(e.size.width,"px; width: ").concat(e.size.width,"px"))}}},{key:"getMaxSizeByWidth",value:function(e){var t=0,n=0;return e.forEach((function(e){e!==U.FORMAT_NAME_FLUID&&(t>e[0]||(t=e[0],n<e[1]&&(n=e[1])))})),t?new v(t,n):null}},{key:"isValidSlotSizeBySlot",value:function(e,t){if(this.SLOT_SIZE_NATIVE[0]===e.width&&this.SLOT_SIZE_NATIVE[1]===e.height)return!0;var n=!1;return t.forEach((function(t){"string"!=typeof t&&(t[0]!==e.width||t[1]!==e.height||(n=!0))})),n}},{key:"extractRenderedSize",value:function(e,t){var n=t.divElement;if(!n)return e;var i=n.querySelector(":scope >div >iframe");return i&&i.hasAttribute("width")&&i.hasAttribute("height")?new v(Number(i.getAttribute("width")),Number(i.getAttribute("height"))):e}},{key:"filterMaxWidth",value:function(e){if(0!==e.maxWidth&&null!==e.maxWidth){var t=[],n=this.windowWidth;this.windowWidth<e.maxWidth&&(n=e.maxWidth),e.sizes.forEach((function(e){e!==U.FORMAT_NAME_FLUID?e[0]<=n&&t.push([e[0],e[1]]):t.push(e)})),e.sizes=t}}},{key:"filterMaxHeight",value:function(e){if(0!==e.maxHeight&&null!==e.maxHeight){var t=[];e.sizes.forEach((function(n){if(!e)throw new Error("adSlot should be defined");n!==U.FORMAT_NAME_FLUID&&e.maxHeight?n[1]<=e.maxHeight&&t.push([n[0],n[1]]):t.push(n)})),e.sizes=t}}},{key:"hasPageAvailableSideSpace",value:function(e){if(null===e)throw new Error("slotSizeManipulator - contentSize should be defined");var t=this.getMinWidthAvailableSideSize();return this.windowWidth>=2*t+e}},{key:"repopulateClientSideSizes",value:function(e,t){if(null===t)throw new Error("slotSizeManipulator - contentSize should be defined");var n=this.getApplicableSizesForSidePosition(t),i=[];if(null===n)throw new Error("slotSizeManipulator - unable to obtain any applicable side sizes");n.forEach((function(e){i.includes(e)||i.push(e)})),e.sizes=i,this.moveLeftWrapper(e)}},{key:"getApplicableSizesForSidePosition",value:function(e){var t=[],n=this.windowWidth,i=this.windowHeight;return this.availableSideSizes.forEach((function(r){n>=2*r[0]+e&&i>=r[1]&&t.push(r)})),0===t.length?null:t}},{key:"getMinWidthAvailableSideSize",value:function(){var e=this.availableSideSizes.map((function(e){return e[0]}));return Math.min.apply(null,e)}}])&&N(t.prototype,n),i&&N(t,i),e}()),x=function(){function e(e,t){var n=this,i=void 0!==t?t:{};this.version="3.7.1",this.userAgent=window.navigator.userAgent||"no `userAgent` provided by the browser",this.props={customStickyChangeNumber:i.customStickyChangeNumber||null,noStyles:i.noStyles||!1,stickyBitStickyOffset:i.stickyBitStickyOffset||0,parentClass:i.parentClass||"js-stickybit-parent",scrollEl:"string"==typeof i.scrollEl?document.querySelector(i.scrollEl):i.scrollEl||window,stickyClass:i.stickyClass||"js-is-sticky",stuckClass:i.stuckClass||"js-is-stuck",stickyChangeClass:i.stickyChangeClass||"js-is-sticky--change",useStickyClasses:i.useStickyClasses||!1,useFixed:i.useFixed||!1,useGetBoundingClientRect:i.useGetBoundingClientRect||!1,verticalPosition:i.verticalPosition||"top",applyStyle:i.applyStyle||function(e,t){return n.applyStyle(e,t)}},this.props.positionVal=this.definePosition()||"fixed",this.instances=[];var r=this.props,o=r.positionVal,a=r.verticalPosition,s=r.noStyles,l=r.stickyBitStickyOffset,u="top"!==a||s?"":l+"px",d="fixed"!==o?o:"";this.els="string"==typeof e?document.querySelectorAll(e):e,"length"in this.els||(this.els=[this.els]);for(var c=0;c<this.els.length;c++){var h,f=this.els[c],p=this.addInstance(f,this.props);this.props.applyStyle({styles:(h={},h[a]=u,h.position=d,h),classes:{}},p),this.instances.push(p)}}var t=e.prototype;return t.definePosition=function(){var e;if(this.props.useFixed)e="fixed";else{for(var t=["","-o-","-webkit-","-moz-","-ms-"],n=document.head.style,i=0;i<t.length;i+=1)n.position=t[i]+"sticky";e=n.position?n.position:"fixed",n.position=""}return e},t.addInstance=function(e,t){var n=this,i={el:e,parent:e.parentNode,props:t};if("fixed"===t.positionVal||t.useStickyClasses){this.isWin=this.props.scrollEl===window;var r=this.isWin?window:this.getClosestParent(i.el,i.props.scrollEl);this.computeScrollOffsets(i),this.toggleClasses(i.parent,"",t.parentClass),i.state="default",i.stateChange="default",i.stateContainer=function(){return n.manageState(i)},r.addEventListener("scroll",i.stateContainer)}return i},t.getClosestParent=function(e,t){var n=t,i=e;if(i.parentElement===n)return n;for(;i.parentElement!==n;)i=i.parentElement;return n},t.getTopPosition=function(e){if(this.props.useGetBoundingClientRect)return e.getBoundingClientRect().top+(this.props.scrollEl.pageYOffset||document.documentElement.scrollTop);var t=0;do{t=e.offsetTop+t}while(e=e.offsetParent);return t},t.computeScrollOffsets=function(e){var t=e,n=t.props,i=t.el,r=t.parent,o=!this.isWin&&"fixed"===n.positionVal,a="bottom"!==n.verticalPosition,s=o?this.getTopPosition(n.scrollEl):0,l=o?this.getTopPosition(r)-s:this.getTopPosition(r),u=null!==n.customStickyChangeNumber?n.customStickyChangeNumber:i.offsetHeight,d=l+r.offsetHeight;t.offset=o?0:s+n.stickyBitStickyOffset,t.stickyStart=a?l-t.offset:0,t.stickyChange=t.stickyStart+u,t.stickyStop=a?d-(i.offsetHeight+t.offset):d-window.innerHeight},t.toggleClasses=function(e,t,n){var i=e,r=i.className.split(" ");n&&-1===r.indexOf(n)&&r.push(n);var o=r.indexOf(t);-1!==o&&r.splice(o,1),i.className=r.join(" ")},t.manageState=function(e){var t=e,n=t.props,i=t.state,r=t.stateChange,o=t.stickyStart,a=t.stickyChange,s=t.stickyStop,l=n.positionVal,u=n.scrollEl,d=n.stickyClass,c=n.stickyChangeClass,h=n.stuckClass,f=n.verticalPosition,p="bottom"!==f,g=n.applyStyle,v=function(e){e()},y=this.isWin&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame)||v,b=this.isWin?window.scrollY||window.pageYOffset:u.scrollTop,m=p&&b<=o&&("sticky"===i||"stuck"===i),w=b>=s&&"sticky"===i;b>o&&b<s&&("default"===i||"stuck"===i)?t.state="sticky":m?t.state="default":w&&(t.state="stuck");var E=b>=a&&b<=s;b<a/2||b>s?t.stateChange="default":E&&(t.stateChange="sticky"),i===t.state&&r===t.stateChange||y((function(){var i,r,o,a,s,u,p={sticky:{styles:(i={position:l,top:"",bottom:""},i[f]=n.stickyBitStickyOffset+"px",i),classes:(r={},r[d]=!0,r)},default:{styles:(o={},o[f]="",o),classes:{}},stuck:{styles:(a={position:"absolute",top:"",bottom:"0"},a[f]="",a),classes:(s={},s[h]=!0,s)}};"fixed"===l&&(p.default.styles.position="");var v=p[t.state];v.classes=((u={})[h]=!!v.classes[h],u[d]=!!v.classes[d],u[c]=E,u),g(v,e)}))},t.applyStyle=function(e,t){var n=e.styles,i=e.classes,r=t,o=r.el,a=r.props,s=o.style,l=a.noStyles,u=o.className.split(" ");for(var d in i){if(i[d])-1===u.indexOf(d)&&u.push(d);else{var c=u.indexOf(d);-1!==c&&u.splice(c,1)}}for(var h in o.className=u.join(" "),n){if(l&&"position"===h)return void(s[h]=n[h]);s[h]=n[h]}},t.update=function(e){var t=this;return void 0===e&&(e=null),this.instances.forEach((function(n){if(t.computeScrollOffsets(n),e)for(var i in e)n.props[i]=e[i]})),this},t.removeInstance=function(e){var t,n,i=e.el,r=e.props;this.applyStyle({styles:(t={position:""},t[r.verticalPosition]="",t),classes:(n={},n[r.stickyClass]="",n[r.stuckClass]="",n)},e),this.toggleClasses(i.parentNode,r.parentClass)},t.cleanup=function(){for(var e=0;e<this.instances.length;e+=1){var t=this.instances[e];t.stateContainer&&t.props.scrollEl.removeEventListener("scroll",t.stateContainer),this.removeInstance(t)}this.manageState=!1,this.instances=[]},e}();var F=function(e,t){return new x(e,t)};function z(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var M,B=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.SKY_SLOT_WRAPPER_ID="admngr-top_ad_place",this.SKY_SLOT_WRAPPER_STICKY_CLASS="sticky-behaviour",this.wrapperAppended=!1,this.stickyAppended=!1,this.allowMultipleAppend=!1}var t,n,r;return t=e,r=[{key:"debug",value:function(e,t){i.a.log("SkySlotManipulator",e,t)}}],(n=[{key:"getWrapperElement",value:function(){return document.getElementById(this.SKY_SLOT_WRAPPER_ID)}},{key:"adjustWrapperSize",value:function(){if(e.debug("wrapper adjustment start"),h.DEFAULT_PAGE_CONTENT_WIDTH!==h.getContentWidth()){var t=this.getWrapperElement();if(null!==t)if(this.isWrapperModificationAllowed()){if(h.LARGE_CONTENT_WIDTH===h.getContentWidth())return t.classList.add(h.CLASS_WRAPPER_WIDTH_1200),e.debug("wrapper adjustment applied (via class)"),void(this.wrapperAppended=!0);t.style.width="".concat(h.getContentWidth(),"px"),e.debug("wrapper adjustment applied (via inline style)"),this.wrapperAppended=!0}else e.debug("wrapper already modified");else e.debug("wrapper element for adjustment not found")}else e.debug("wrapper adjustment is set to default")}},{key:"addStickyBehaviour",value:function(){var t=this.getWrapperElement();null!==t&&(this.isStickyAppendAllowed()?(t.classList.add(this.SKY_SLOT_WRAPPER_STICKY_CLASS),F(t,{noStyles:!0}),e.debug("sticky behaviour appended"),this.stickyAppended=!0):e.debug("sticky already appended"))}},{key:"setMultipleAppendEnabled",value:function(e){this.allowMultipleAppend=e}},{key:"isStickyAppendAllowed",value:function(){return!!this.allowMultipleAppend||!this.stickyAppended}},{key:"isWrapperModificationAllowed",value:function(){return!!this.allowMultipleAppend||!this.wrapperAppended}}])&&z(t.prototype,n),r&&z(t,r),e}());function H(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var W=new((M=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.REFRESH_GATE_TIME=60,this.REFRESH_SCREEN_TIME=30,this.isGateRequested=!1,this.gateDependentSlots={},this.runSlotsDefer=!0,this.GATE_DEFER_TIME=500,this.GATE_AD_UNIT_PATH="widea",this.GATE_SIZE_WIDTH=1,this.GATE_SIZE_HEIGHT=1}var t,n,r;return t=e,r=[{key:"getGateElement",value:function(){return document.querySelector(e.GATE_SELECTOR)}},{key:"showSkyWrapper",value:function(){e.toggleSkyWrapperDisplay(!0)}},{key:"hideSkyWrapper",value:function(){e.toggleSkyWrapperDisplay(!1)}},{key:"toggleSkyWrapperDisplay",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=B.getWrapperElement();if(null!==n){if(t)return e.debug("show sky wrapper element",n),void p.show(n);e.debug("hiding sky wrapper element",n),p.hide(n)}}},{key:"removeGateSize",value:function(t){e.debug("removeGateSize: removing 1x1 size from gateSlot...",t);var n=t.getSizesWithoutGate();n.length!==t.sizes.length?(t.sizes=n,t.forceReload=!0,t.forceReloadPerformed=!1,e.debug("removeGateSize: 1x1 size removed, forceReload set to true",t)):e.debug("removeGateSize: 1x1 already removed, ending...",t)}},{key:"updateRefreshTime",value:function(t,n){0!==t.refreshAfter?U.EMPTY_SLOT_REFRESH_TIME!==t.refreshAfter?(t.refreshAfter=n,l.update(t,"refreshAfter"),e.debug("updateRefresh: gate to ".concat(n,"sec"))):e.debug("updateRefresh: gate update denied, already set empty refresh time"):e.debug("updateRefresh: gate set not to refresh - stop")}},{key:"debug",value:function(e,t){i.a.log("GateHandler",e,t)}}],(n=[{key:"isGateVisible",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!==e&&void 0!==e.adUnitPath&&1<e.adUnitPath.toLowerCase().indexOf(this.GATE_AD_UNIT_PATH)&&null!==e.size&&this.GATE_SIZE_WIDTH===e.size.width&&this.GATE_SIZE_HEIGHT===e.size.height}},{key:"addGateDependentSlot",value:function(t){this.gateDependentSlots[t.divId]=t,e.debug("addGateDependentSlot: adding slot:",t),this.isGateRequested&&!this.isGateVisible()&&(e.debug("addGateDependentSlot: gateRequested will show this slot now! :",t),this.displayGateNotDisplayedAwareSlots())}},{key:"setGateRequested",value:function(t){e.debug("setGateRequested:",t),this.isGateRequested=t}},{key:"runSlots",value:function(t){return e.debug("runSlots: running gate slot...",t),this.isGateVisible(t)?(e.debug("runSlots: gate IS visible, disabling gate refresh capability and will end"),e.updateRefreshTime(t,this.REFRESH_GATE_TIME),void e.hideSkyWrapper()):this.runSlotsDefer?(this.runSlotsDefer=!1,e.debug("runSlots: defer runSlots",t),void setTimeout((function(){window.dispatchEvent(new CustomEvent("SmeAdManager.gateRendered",{detail:{providerName:"gtg",divId:t.divId}}))}),this.GATE_DEFER_TIME)):(e.debug("runSlots: gate IS NOT visible will show skyscrapers..."),e.removeGateSize(t),t.consecutiveEmpty||e.updateRefreshTime(t,this.REFRESH_SCREEN_TIME),void this.forceGateAwareSlots())}},{key:"forceGateAwareSlots",value:function(){this.displayGateNotDisplayedAwareSlots(),null!==B.getWrapperElement()?(B.adjustWrapperSize(),B.addStickyBehaviour(),e.debug("runSlots: stickyWrapper on sky slots initialized")):e.debug("runSlots: stickyWrapper not found, stickyWrapper will NOT be initialized")}},{key:"reset",value:function(){this.setGateRequested(!1),this.gateDependentSlots={},this.runSlotsDefer=!0}},{key:"gateWrapperRendered",value:function(){return null!==e.getGateElement()}},{key:"destroy",value:function(){var t=e.getGateElement();t&&(t.remove(),e.debug("Gate element removed."))}},{key:"preservePlaceholderHeight",value:function(t){if(t){var n=e.getGateElement();if(n){var i=n.offsetHeight;i&&(t.setAttribute(e.GATE_HEIGHT_LOCK_MARK,""),p.setHeightInPx(t,i))}}}},{key:"displayGateNotDisplayedAwareSlots",value:function(){var t=this;e.debug("displayGateNotDisplayedAwareSlots: displaying gateAware slots...",this.gateDependentSlots);var n=!0;Object.keys(this.gateDependentSlots).forEach((function(i){var r=t.gateDependentSlots[i];e.debug("displayGateNotDisplayedAwareSlots: processing gateAware slot:",r),r.loadInitialized&&(n=!1),!r.loadInitialized&&j.sizeAvailable(r)&&(e.debug("displayGateNotDisplayedAwareSlots: displaying gateAware slot:",r),r.provider.display(i,!0),n=!1)})),n?e.hideSkyWrapper():e.showSkyWrapper()}},{key:"removeGateHeightLockMark",value:function(t){t.hasAttribute(e.GATE_HEIGHT_LOCK_MARK)&&(t.removeAttribute(e.GATE_HEIGHT_LOCK_MARK),t.style.removeProperty&&t.style.removeProperty("height"))}}])&&H(t.prototype,n),r&&H(t,r),e}()).GATE_SELECTOR=".gate-wrapper",M.GATE_HEIGHT_LOCK_MARK="advm_height_locked",M);function G(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var q="no-ad-slot",V=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._empty=!0,this._width=0,this._height=0,this._position=t?t.positionName:q,this._elementId=t?t.divId:q}var t,n,i;return t=e,(n=[{key:"position",get:function(){return this._position}},{key:"elementId",get:function(){return this._elementId}},{key:"empty",get:function(){return this._empty}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}])&&G(t.prototype,n),i&&G(t,i),e}();function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function K(e,t){return!t||"object"!==J(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Z=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=K(this,X(t).call(this,e)))._format=null,n._parentDivId=null,n._nonAdvertPopulationAvailable=null,n._empty=t.isEmpty(e.size,i);var a=t.resolveSize(e,n._empty,r);return null!==a&&(n._width=a.width,n._height=a.height),n._format=t.resolveFormat(e,o),e.parentSlotDivId&&(n._parentDivId=e.parentSlotDivId),n._nonAdvertPopulationAvailable=t.resolveNonAdvertPopulationAvailability(e,n._empty),n}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(t,e),n=t,r=[{key:"isEmpty",value:function(e,t){return null!==t?t:null===e}},{key:"resolveSize",value:function(e,n,i){return n?null:i||(e.size?t.isFluid(e)?new v(1,1):e.size:null)}},{key:"resolveFormat",value:function(e,n){return n||(e.isGateCapable&&W.isGateVisible(e)?U.FORMAT_NAME_GATE:t.isFluid(e)?U.FORMAT_NAME_FLUID:null)}},{key:"isFluid",value:function(e){return e.isFluidContent||e.hasFluidSize()}},{key:"resolveNonAdvertPopulationAvailability",value:function(e,t){if(!t)return!1;if(e.refreshAfter)return!1;var n=!1;return"article_body_top_position"===e.positionName&&(n=!0),!n||e.signalModifier&&!!e.signalModifier.applied||null}}],(i=[{key:"format",get:function(){return this._format}},{key:"parentDivId",get:function(){return this._parentDivId}},{key:"nonAdvertPopulationAvailable",get:function(){return this._nonAdvertPopulationAvailable}}])&&Y(n.prototype,i),r&&Y(n,r),t}(V),$=n("hjvm");function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ne(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oe=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ne(this,ie(t).call(this,e)))._eventName=null,i._eventName=n,i._empty=t.resolveEmptyByEvent(n),i._empty||(i._width=1,i._height=1),i}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,e),n=t,r=[{key:"resolveEmptyByEvent",value:function(e){return $.c===e||$.b===e}}],(i=[{key:"eventName",get:function(){return this._eventName}}])&&te(n.prototype,i),r&&te(n,r),t}(V);function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function le(e,t){return!t||"object"!==ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ce=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=le(this,ue(t).call(this)))._message=e,n}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(t,e),n=t,(i=[{key:"message",get:function(){return this._message}}])&&se(n.prototype,i),r&&se(n,r),t}(V);function he(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fe=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.EVENT_VIDEO_EVENT="slot.videoEvent",this.LIST_STORE_UNIQUE=!1,this.LIST_STORE_LIMIT=20}var t,n,i;return t=e,i=[{key:"envelop",value:function(e){return{detail:e}}},{key:"envelopWithEvent",value:function(e,t){return{data:e,event:t}}}],(n=[{key:"disabledState",value:function(){var t=new ce("User state disallows run.");this.notify("state.disabled",e.envelop(t)),this.notify("userDisplay.disabled",e.envelop(t))}},{key:"positionRendered",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=new Z(t,n,i,r);this.notify("slot.positionRendered",e.envelop(o))}},{key:"videoEvent",value:function(t,n){if([$.e,$.a,$.c].includes(n)){var i=new oe(t,n);this.notify(this.EVENT_VIDEO_EVENT,e.envelop(i)),this.positionRendered(t,i.empty,new v(i.width,i.height),"video")}}},{key:"getStorage",value:function(){return window.smeAdManager.journal}},{key:"notify",value:function(e,t){window.dispatchEvent(new CustomEvent("".concat("SmeAdManager",".").concat(e),t)),this.pushToList(e,t)}},{key:"pushToList",value:function(t,n){var i=this.getStorage();this.LIST_STORE_LIMIT<=i.length||this.LIST_STORE_UNIQUE&&this.hasJournalRecord(t,n)||i.push(e.envelopWithEvent(n,t))}},{key:"hasJournalRecord",value:function(e,t){var n=this.getStorage(),i=!1;return n.forEach((function(n){if("slot.positionRendered"===n.event){var r=t.detail;return r instanceof Z&&n.data.detail instanceof Z&&r.position===n.data.detail.position?void(i=!0):void 0}n.event===e&&(i=!0)})),i}}])&&he(t.prototype,n),i&&he(t,i),e}());function pe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ge=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled=!1}var t,n,r;return t=e,r=[{key:"getRenderAttributes",value:function(t){if(e.isFluid(t))return{height:"50px",label:U.FORMAT_NAME_FLUID,width:"100%",size:new v(300,50)};var n=e.getSlotMaxSizeByWidth(t);return n?{height:"".concat(n.height,"px"),label:"".concat(n.width,"x").concat(n.height),width:"".concat(n.width,"px"),size:n}:null}},{key:"getSlotMaxSizeByWidth",value:function(e){var t,n,i=null!==(t=e.sizes)&&void 0!==t?t:null===(n=e.fallback)||void 0===n?void 0:n.sizes;return i?j.getMaxSizeByWidth(i):null}},{key:"adjustAlignment",value:function(t){e.isFluid(t)||null!==t.divElement&&(p.removeOverflow(t.divElement),t.size&&p.centerWrapperBySize(t.divElement,t.size.width),t.position.isSkyLeft()&&j.moveLeftWrapper(t),t.position.isSkyPosition()&&null!==t.divElement&&p.removeEmptySize(t.divElement))}},{key:"injectHtml",value:function(e,t){if(e.divElement){e.divElement.setAttribute("style","width:".concat(t.width,"; height:").concat(t.height,";")),e.divElement.classList.add("advm-pp-box");var n=document.createElement("span");n.classList.add("advm-pp-label"),n.textContent="".concat(e.positionName,": ").concat(t.label),e.divElement.appendChild(n)}}},{key:"isFluid",value:function(e){return!!e.isFluidContent||e.hasFluidSize()}},{key:"debug",value:function(e,t){i.a.log("PlacementPreview",e,t)}}],(n=[{key:"enable",value:function(e){this.enabled=!0;var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(t)}},{key:"active",value:function(){return this.enabled}},{key:"render",value:function(t){if(e.debug('Slot "'.concat(t.positionName,'" preview active, rendering.')),null===t.divElement)throw new Error('divElement for position "'.concat(t.positionName,'" should not be null'));var n=e.getRenderAttributes(t);n?(t.size=n.size,t.label.show(),e.adjustAlignment(t),e.injectHtml(t,n),fe.positionRendered(t),e.debug('Slot "'.concat(t.positionName,'" preview rendered.'))):e.debug("Could not obtain preview attributes.",t)}}])&&pe(t.prototype,n),r&&pe(t,r),e}());function ve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ye=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adSlots={},this.adSlotDefinitions={},this.immediatePositionResolving=!1}var t,n,r;return t=e,r=[{key:"resolveCorrectAdSlot",value:function(e){var t=e.length;if(1===t)return e[0];var n=e[Math.floor(Math.random()*t)];return i.a.log("Ad Definition Resolver",n.positionName,"The position is A/B tested and '"+n.divId+"' has been randomly selected"),n}}],(n=[{key:"addAdSlot",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!1===this.adSlots.hasOwnProperty(e.positionName)&&(this.adSlots[e.positionName]=[],this.adSlotDefinitions[e.positionName]=[]),this.adSlots[e.positionName].push(e),null!==t&&this.adSlotDefinitions[e.positionName].push(t),this.immediateResolve(e.positionName)}},{key:"resolve",value:function(){var e=this;Object.keys(this.adSlots).forEach((function(t){return e.defineSlotForPositionName(t)})),this.immediatePositionResolving=!0}},{key:"has",value:function(e,t){return this.adSlots[e]&&this.adSlots[e].some((function(e){return e.divId===t}))}},{key:"getAdSlotNameList",value:function(){return Object.keys(this.adSlots)}},{key:"getFirstAdSlot",value:function(e){return this.adSlots[e]?this.adSlots[e][0]:null}},{key:"getFirstAdSlotDefinition",value:function(e){return this.adSlotDefinitions[e]?this.adSlotDefinitions[e][0]:null}},{key:"reset",value:function(){this.adSlots={},this.adSlotDefinitions={},this.immediatePositionResolving=!1}},{key:"defineSlotForPositionName",value:function(t){var n=e.resolveCorrectAdSlot(this.adSlots[t]);this.adSlots[t]=[n],n.provider.defineSlot(n)}},{key:"immediateResolve",value:function(e){!1!==this.immediatePositionResolving&&this.defineSlotForPositionName(e)}}])&&ve(t.prototype,n),r&&ve(t,r),e}());function be(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var me=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adSlots=new Map,this.callbacks=new Map,this.initialized=!1,this.debug("constructor()"),"loading"===document.readyState?(window.addEventListener("DOMContentLoaded",this.make.bind(this)),this.debug("make will be initialized on DOMContentLoaded")):(this.make(),this.debug("make triggerd, domcontentloaded fired"))}var t,n,r;return t=e,(n=[{key:"make",value:function(){var e=this;this.initialized=!0,this.adSlots.forEach((function(t){if(e.debug("Adding observer",t),t.lazyObserved)e.debug("Slot already observed",t);else{var n={rootMargin:"0px 0px 0px 0px"},i=null;if(null!==t.lazyLoadOffsetFromTop&&((i=document.createElement("div")).setAttribute("data-observed-element-for-adslot-id",t.divId),i.setAttribute("style","position:absolute;width:1px;height:1px;top:"+t.lazyLoadOffsetFromTop+"px;left:0;"),document.body.appendChild(i),n.rootMargin="30000px 0px 0px 0px"),null!==t.lazyLoadOffset&&t.lazyLoadOffset>0&&(n.rootMargin=t.lazyLoadOffset+"px 0px "+t.lazyLoadOffset+"px 0px"),null!==i||(i=t.divElement)instanceof Element){var r=new IntersectionObserver(e.onIntersection.bind(e),n);r.observe(i),t.lazyObserved=!0,t.observer=r,e.debug("lazyload observing",t)}else console.warn('[SMEADVM] [LazyDisplayFactory] Element "'.concat(t.divId,'" for lazy slot not found'))}}))}},{key:"onIntersection",value:function(e,t){this.debug("onIntersection()");var n=e[0];if(n.isIntersecting){var i=n.target.getAttribute("id"),r=null;if(!i){if(!(i=n.target.getAttribute("data-observed-element-for-adslot-id")))throw new Error("Lazy observed AdSlot element has no ID or ID related attribute.");r=n.target}var o=this.adSlots.get(i);if(this.debug("intersecting adSlot",o),this.callbacks.has(o.divId)){var a=this.callbacks.get(o.divId);if(this.debug("running custom callback for adSlot divId: "+o.divId),a())return void this.clearObserver(t,o,r)}o.loadInitialized||(this.debug("initializing adSlot",o),o.provider.display(o.divId,!0),this.clearObserver(t,o,r))}else this.debug("entry is NOT intersecting, ignoring)",n)}},{key:"add",value:function(e,t){this.debug("adding adSlot",e),this.adSlots.has(e.divId)?this.debug("Lazy adSlot `"+e.divId+"` for intersection observing already defined",e):(this.adSlots.set(e.divId,e),t&&this.callbacks.set(e.divId,t),this.initialized&&this.make())}},{key:"clearObserver",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.debug("clearObserver()",t),e.disconnect(),this.adSlots.delete(t.divId),this.callbacks.delete(t.divId),n){this.debug("removing observed element",n);var i=n.parentNode;i&&i.removeChild(n)}}},{key:"detachSlot",value:function(e){var t=this;this.debug("detachSlot",e),this.adSlots.forEach((function(n){n.divId===e.divId&&(null!==n.observer?(t.clearObserver(n.observer,n),e.lazyObserved=!1,e.loadInitialized=!1):t.debug("detachSlot - slot has no observer",n))}))}},{key:"debug",value:function(e,t){i.a.log("lazyFactory",e,t)}}])&&be(t.prototype,n),r&&be(t,r),e}());function we(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ee=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"filter",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===n||"*"===n)return Array.from(e.values());var i=":",r=["<",">","<=",">="];r.forEach((function(e){n.indexOf(e)>0&&(i=e)}));var o=n.split(i,2),a=o[0],s=o[1];"true"===s&&(s=!0),"false"===s&&(s=!1);var l=[];return e.forEach((function(e,n){t.match(e,a,i,s)&&l.push(e)})),l}},{key:"match",value:function(e,t,n,i){if(!e.hasOwnProperty(t))return!1;var r=e[t];switch(n){case":":return r===i;case">":return r>i;case">=":return r>=i;case"<":return r<i;case"<=":return r<=i;default:throw new Error('Unknown operator "'.concat(n,'"'))}}}])&&we(t.prototype,n),i&&we(t,i),e}());function Se(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ke=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.INTERVAL_TIME=100,this.MAX_CYCLE=1200,this.RECURSIVE_CMP_LOAD_MAX_TRIES=50,this.RECURSIVE_CMP_LOAD_TIMEOUT=70,this.intervalId=0,this.currentCycle=0,this.recursiveCmpLoadAmount=0}var t,n,i;return t=e,(n=[{key:"awaitObject",value:function(){var t=this;return new Promise((function(n,i){t.intervalId=window.setInterval((function(){if(t.currentCycle++,t.MAX_CYCLE<=t.currentCycle)return i(e.AWAIT_TIMEOUT),void t.clearInterval();void 0!==window.__tcfapi&&(n(e.AWAIT_SUCCESS),t.clearInterval())}),t.INTERVAL_TIME)}))}},{key:"awaitCmpLoaded",value:function(){return new Promise((function(t,n){window.__tcfapi("addEventListener",2,(function(i){"loaded"!==i.cmpStatus||void 0===i.publisher||void 0===i.publisher.restrictions?("loaded"===i.cmpStatus&&void 0!==i.eventStatus&&"cmpuishown"===i.eventStatus&&t(e.AWAIT_SUCCESS),n(e.AWAIT_NOT_LOADED)):t(e.AWAIT_SUCCESS)}))}))}},{key:"awaitCmpLoadedRecursive",value:function(){var t=this;return new Promise((function(n,i){t.recursiveCmpLoadAmount++,t.RECURSIVE_CMP_LOAD_MAX_TRIES<=t.recursiveCmpLoadAmount?i(e.AWAIT_MAX_TIES_REACHED):t.awaitCmpLoaded().then((function(){n(e.AWAIT_SUCCESS)})).catch((function(){setTimeout((function(){t.awaitCmpLoadedRecursive().then((function(){n(e.AWAIT_SUCCESS)})).catch((function(){i(e.AWAIT_MAX_TIES_REACHED)}))}),t.RECURSIVE_CMP_LOAD_TIMEOUT)}))}))}},{key:"clearInterval",value:function(){window.clearInterval(this.intervalId),this.intervalId=0}}])&&Se(t.prototype,n),i&&Se(t,i),e}();function _e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}ke.AWAIT_SUCCESS="success",ke.AWAIT_TIMEOUT="timeout",ke.AWAIT_NOT_LOADED="not-loaded-cmp",ke.AWAIT_MAX_TIES_REACHED="max-tries";var Ae=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.initializeGTM()}var t,n,r;return t=e,r=[{key:"pushGtmEvent",value:function(e){e.action="advert_"+e.action,e.event=e.action+"_"+e.provider,window.dataLayer.push(e)}},{key:"debug",value:function(e,t){i.a.log("StatsTracker",e,t)}},{key:"initializeGTM",value:function(){window.dataLayer=window.dataLayer||[]}}],(n=[{key:"track",value:function(t){e.debug("Track",t),e.pushGtmEvent(t)}}])&&_e(t.prototype,n),r&&_e(t,r),e}());function Oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ce=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adRefresher=null,this.initialized=!1,this.loaded=!1,this.adSlots=new Map,this.pendingObserveAdSlots=new Map,this.internalCommands=new Map,this.internalCommandExecutionPaused=!1,this.pausedInternalCommandPositionList=new Set,this.targeting=new Map,this.pageContentWidth=null,this.requirements=null,this.providerAdRefresher=null,this.tcfApiLoader=null,this.TCFAPI_LOAD_DEFER=100,this.name=t,this.userDisplayResolver=n,window.addEventListener("SmeConsent.tcfapi.loaded",this.onTcfapiLoadedHandler.bind(this))}var t,n,r;return t=e,r=[{key:"isConsentWrapperPresent",value:function(){return void 0!==window.smeConsent}}],(n=[{key:"initialize",value:function(e){if(this.initialized)this.debug("already initialized");else{if(null===e){if(null===this.providerAdRefresher)return void this.debug("initialization required ad refresher instance");e=this.providerAdRefresher}else this.providerAdRefresher=e;if(!this.areRequirementsFulfilled())return this.debug("requirements UN-fulfilled, stopping provider - await fulfill, block execution",[window.smeConsent,window.__tcfapi]),this.setInternalCommandExecutionPaused(!0),void this.awaitRequirements();this.setAdRefresher(e),this.initialized=!0,this.setInternalCommandExecutionPaused(!1),this.debug("initialization success")}}},{key:"setRequirements",value:function(e){this.requirements=e}},{key:"setAdRefresher",value:function(e){this.adRefresher=e,this.processPendingObserveAdSlots()}},{key:"setTargeting",value:function(e,t){this.targeting.set(e,t)}},{key:"getTargeting",value:function(){return this.targeting}},{key:"clearTargeting",value:function(){this.debug('Unsupported method "clearTargeting"')}},{key:"setInternalCommandExecutionPaused",value:function(e){this.debug("setInternalCommandExecutionPaused (".concat(this.internalCommands.size,") "),e),this.internalCommandExecutionPaused=e,e||this.runInternalCommands()}},{key:"pauseInternalCommandsForPosition",value:function(e){this.debug("add pausedInternalCommandPositionList"),this.pausedInternalCommandPositionList.add(e)}},{key:"runInternalCommandsForPosition",value:function(e){this.pausedInternalCommandPositionList.delete(e),this.runInternalCommands()}},{key:"addInternalCommand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_",n=[];this.internalCommands.has(t)&&(n=this.internalCommands.get(t)),n.push(e),this.internalCommands.set(t,n),this.runInternalCommands()}},{key:"createAdSlotFromDefinition",value:function(e){return U.createFromDefinition(e)}},{key:"getRestoreDefinition",value:function(e){throw new Error('"getRestoreDefinition()" is not supported')}},{key:"defineSlot",value:function(e){throw new Error('"defineSlot()" is not supported')}},{key:"start",value:function(){throw new Error('"start()" is not supported')}},{key:"display",value:function(e,t){throw new Error('"display()" is not supported')}},{key:"refresh",value:function(e){throw new Error('"refresh()" is not supported')}},{key:"getAdSlotByDivId",value:function(e){var t=this.adSlots.get(e);return t?(this.debug('found adSlot with ID "'+e+'"',t),t):(this.debug('adSlot with ID "'+e+'" does not exist'),null)}},{key:"getAdSlots",value:function(e){this.debug("getAdSlots()",e);var t=Ee.filter(this.adSlots,e);return this.debug("selected adSlots: "+t.length,e),t}},{key:"destroy",value:function(e){throw new Error('"destroy()" is not supported')}},{key:"reset",value:function(){this.debug("Reset not supported.")}},{key:"gateRenderedHandler",value:function(e){throw new Error('"gateRenderedHandler()" is not supported')}},{key:"markAsLoaded",value:function(){this.loaded=!0,this.runInternalCommands()}},{key:"biddingEnd",value:function(e,t){this.debug('Unsupported method "biddingEnd"')}},{key:"onUserLoaded",value:function(e){}},{key:"toString",value:function(){return this.name}},{key:"setPageContentWidth",value:function(e){this.pageContentWidth=e}},{key:"trackStat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.provider=t||this.name,Ae.track(e)}},{key:"addToPendingObserveAdSlots",value:function(e){this.pendingObserveAdSlots.has(e.divId)||this.pendingObserveAdSlots.set(e.divId,e)}},{key:"unLockSlotPlaceholderHeight",value:function(e){if(this.debug("unLockSlotPlaceholderHeight()",e),null===e.divElement)throw new Error("divElement should not be null");e.divElement.style.removeProperty&&e.divElement.style.removeProperty("height")}},{key:"updateSlotSize",value:function(e,t,n){null===e.size&&!e.lazy||n.isSameAs(e.size)||(window.dispatchEvent(new CustomEvent("SmeAdManager.adSizeChanged",{detail:{divId:t}})),this.debug("dispatched adSizeChanged event for adSlot "+t)),e.size=n,this.debug("set size for adSlot",e.size),l.update(e,"size")}},{key:"displayElement",value:function(e){null!==e.divElement&&(e.restoreRefreshTime(),p.removeEmptySize(e.divElement),p.removeOverflow(e.divElement),p.show(e.divElement))}},{key:"hideSlot",value:function(e){if(null!==e.divElement){e.useEmptySlotRefreshTime(),p.setEmptySize(e.divElement),p.setOverflow(e.divElement),e.label.hide(),l.update(e);var t=e.divElement.childNodes;if(1===t.length){var n=t[0];""!==n.style.width&&""!==n.style.height&&(this.debug("Clearing adSlot divElement`s child size",n),n.style.width="",n.style.height="")}}}},{key:"runInternalCommandsTrigger",value:function(){this.runInternalCommands()}},{key:"debug",value:function(e,t){i.a.log("provider "+this.name,e,t)}},{key:"runInternalCommands",value:function(){var e=this;this.loaded?this.internalCommandExecutionPaused?this.debug("internal commands execution is paused, execution skipped"):this.internalCommands.forEach((function(t,n){e.pausedInternalCommandPositionList.has(n)?e.debug('internal command execution for position "'+n+'" is paused, execution skipped'):(t.forEach((function(t){e.debug("executing internal command for position: "+n),t()})),e.internalCommands.delete(n))})):this.debug("library not yet loaded, internal commands execution postponed")}},{key:"areRequirementsFulfilled",value:function(){if(this.debug("/Requirements check start"),null===this.requirements)return this.debug("/Requirements - global not defined"),!0;if(!e.isConsentWrapperPresent())return this.debug("/Requirements consent for page not implemented - no ECMP present."),!0;var t=this.isConsentAwaitRequirementFulfilled(),n=this.isTcfapiAwaitRequirementFulfilled();return t&&this.requirements.setConsentAwaitFilled(t),n&&this.requirements.setTcfapiAwaitFilled(n),!(!t||!n)||(this.debug("/Requirements Un-Fulfilled"),!1)}},{key:"isConsentAwaitRequirementFulfilled",value:function(){var e;return this.debug("/Requirements check consentAwait"),(null===(e=this.requirements)||void 0===e?void 0:e.consentAwait)?this.userDisplayResolver.isUserConsentReady()?(this.debug("/Requirements consent ready"),!0):null!==this.userDisplayResolver.getConsentHandler()?(this.debug("/Requirements consent handler present",window.smeConsent),!0):(this.debug("/Requirements - consentAwait not fulfilled"),!1):(this.debug("/Requirements no consent await"),!0)}},{key:"isTcfapiAwaitRequirementFulfilled",value:function(){var e,t;return this.debug("/Requirements Check tcfapiAwait."),(null===(e=this.requirements)||void 0===e?void 0:e.tcfapiAwait)?(null===(t=this.requirements)||void 0===t?void 0:t.isTcfapiAwaitFilled)?(this.debug("/Requirements Filled from previous step."),!0):void 0===window.__tcfapi?(this.debug("/Requirements - undefined tcfapi - tcfapiAwait not fulfilled"),!1):(this.debug("/Requirements tcfapi partially ready, BUT need to async check ready state",window.__tcfapi),!1):(this.debug("/Requirements No tcfapi await required."),!0)}},{key:"awaitRequirements",value:function(){var e=this;if(null!==this.requirements){if(this.debug("/Requirements async await"),this.requirements.consentAwait&&!this.requirements.isConsentAwaitFilled){this.debug("/Requirements async await - consent");var t=function(){e.initialize(null),e.debug("/Requirements callback - consent")};this.userDisplayResolver.fetchUserConsent(t,t,!0)}if(this.requirements.tcfapiAwait&&!this.requirements.isTcfapiAwaitFilled&&null===this.tcfApiLoader){this.debug("/Requirements async await - tcfapi");var n=function(t){e.debug("/Requirements tcfapi - callback ".concat(t)),ke.AWAIT_SUCCESS===t?e.getTcfApiLoader().awaitCmpLoadedRecursive().then(e.dispatchTcfApiReady.bind(e)).catch(e.dispatchTcfApiReady.bind(e)):e.dispatchTcfApiReady(t)};this.getTcfApiLoader().awaitObject().then(n).catch(n)}}}},{key:"getTcfApiLoader",value:function(){return this.tcfApiLoader||(this.tcfApiLoader=new ke),this.tcfApiLoader}},{key:"dispatchTcfApiReady",value:function(e){var t;this.debug('TcfApi ready with status "'.concat(e,'"')),null===(t=this.requirements)||void 0===t||t.setTcfapiAwaitFilled(!0),setTimeout((function(){window.dispatchEvent(new CustomEvent("SmeConsent.tcfapi.loaded",{detail:e}))}),this.TCFAPI_LOAD_DEFER)}},{key:"onTcfapiLoadedHandler",value:function(e){var t,n;this.debug('Event "SmeConsent.tcfapi.loaded" has occurred',e),e instanceof CustomEvent?(null===(t=this.requirements)||void 0===t?void 0:t.tcfapiAwait)?(this.debug("__tcfapi available",window.__tcfapi),void 0!==window.__tcfapi&&(null===(n=this.requirements)||void 0===n||n.setConsentAwaitFilled(!0)),this.initialize(null),this.debug("/Requirements callback - tcfapi - init triggered")):this.debug("Event call not awaited."):this.debug('Event call must be type "CustomEvent"!')}},{key:"processPendingObserveAdSlots",value:function(){var e=this,t=this.pendingObserveAdSlots;this.pendingObserveAdSlots=new Map,t.forEach((function(t){e.adRefresher&&e.adRefresher.observe(t)}))}}])&&Oe(t.prototype,n),r&&Oe(t,r),e}();function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pe(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var De=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Pe(this,Re(t).apply(this,arguments))).ref=null,e.consecutiveEmpty=0,e.filledCount=0,e.parentSlotDivId=null,e}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(t,e),n=t,r=[{key:"createFromDefinition",value:function(e){var n=new t(e.provider,e.positionName,e.adUnitPath,e.sizes,e.divId);return U.fillAdSlotFromDefinition(n,e),n}}],(i=null)&&Te(n.prototype,i),r&&Te(n,r),t}(U);function Ue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ne=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.placementSelector=null,this.NODE_SCRIPT_NAME="script"}var t,n,r;return t=e,r=[{key:"insertAfter",value:function(e,t){var n;null===(n=t.parentNode)||void 0===n||n.insertBefore(e,t.nextSibling)}},{key:"debug",value:function(e,t){i.a.log("ResourceLoader",e,t)}}],(n=[{key:"setup",value:function(e){e.trim()&&(this.placementSelector=e)}},{key:"placeScript",value:function(t,n){if(!t)throw new Error("No script resource url provided.");var i=document.createElement(this.NODE_SCRIPT_NAME);i.src=t,n.elementId&&(i.id=n.elementId),n.async&&(i.async=!0),i.onload=function(){n.successCallback&&n.successCallback(),e.debug('Success load callback on Resource url "'.concat(t,'".'))},i.onerror=function(){n.errorCallback&&n.errorCallback(),e.debug('Error load callback on Resource url "'.concat(t,'".'))};var r=this.getInsertNode();if(!r)throw new Error("No insert node available.");e.insertAfter(i,r),e.debug('Script url "'.concat(t,'" placed.'))}},{key:"getInsertNode",value:function(){var e=this.placementSelector&&document.querySelector(this.placementSelector)||document.getElementsByTagName("script")[0];return e instanceof HTMLElement&&e.parentNode?e:null}}])&&Ue(t.prototype,n),r&&Ue(t,r),e}());var je,xe=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elementId=t,this.successCallback=n&&n.hasOwnProperty("successCallback")&&void 0!==n.successCallback?n.successCallback:null,this.errorCallback=n&&n.hasOwnProperty("errorCallback")&&void 0!==n.errorCallback?n.errorCallback:null,this.async=!n||!n.hasOwnProperty("async")||!!n.async};function Fe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ze=new((je=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._enabled=null}var t,n,r;return t=e,r=[{key:"initLibraryWithCmp",value:function(){e.debug("CMP callback with success."),e.initLibrary()}},{key:"initLibraryWithoutCmp",value:function(){e.debug("CMP callback without cmp installed."),e.initLibrary()}},{key:"initLibrary",value:function(){e.debug("Init PWT library"),Ne.placeScript(e.getLibraryUrl(),new xe("sme-ad-manager-pwt"))}},{key:"preloadLibrary",value:function(){var t=e.getLibraryUrl();"function"==typeof window.smeAdManagerPreload&&window.smeAdManagerPreload(t,"script")}},{key:"getLibraryUrl",value:function(){var t=window.location.href,n="";if(t.indexOf("pwtv=")>0){var i=/pwtv=(.*?)(&|$)/g.exec(t);i&&i.length>=2&&i[1].length>0&&(n="/"+i[1])}return"".concat(e.PWT_LIB_URL).concat(n,"/pwt.js")}},{key:"debug",value:function(e,t){i.a.log("/DfpPubmaticOpenWrap",e,t)}}],(n=[{key:"setup",value:function(t){this._enabled=t.enabled,e.debug("Config setup ".concat(this.enabled?"is":"is not"," enabled."))}},{key:"initialize",value:function(t){e.debug("Initializing."),window.PWT=window.PWT||{},window.PWT.jsLoaded=function(){e.debug("Js loaded, calling gpt load."),t()},e.preloadLibrary(),(new ke).awaitCmpLoadedRecursive().then(e.initLibraryWithCmp.bind(this)).catch(e.initLibraryWithoutCmp.bind(this))}},{key:"enabled",get:function(){var e;return null!==(e=this._enabled)&&void 0!==e&&e}}])&&Fe(t.prototype,n),r&&Fe(t,r),e}()).PWT_LIB_URL="https://ads.pubmatic.com/AdServer/js/pwt/162247/7789",je);var Me=function e(t,n,i,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.empty=n,this.displayElement=i,this.element=r,this.signalModifier=o};function Be(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var He=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.watching=!1,this.WRAPPER_ELEMENT_ID_PREFIX="adm-smw-",this.stack=new Map}var t,n,r;return t=e,r=[{key:"debug",value:function(e,t){i.a.log("SignalPositionRendered",e,t)}}],(n=[{key:"add",value:function(t,n,i,r,o){this.stack.has(t)?e.debug('Item "'.concat(t,'" already added.')):r?(this.stack.set(t,new Me(t,n,i,this.resolveTargetElement(r),o)),e.debug('Position "'.concat(t,'" added.')),this.watching||this.watch()):e.debug('Item "'.concat(t,'" has no element boundary.'))}},{key:"eventTrigger",value:function(e){this.trigger(e.detail)}},{key:"trigger",value:function(t){e.debug("Position rendered event processing",t);var n=this.stack.get(t.position);void 0!==n?n.empty===t.empty?(this.processItemAction(n),this.markModifierAccomplished(n),this.stack.delete(t.position),0===this.stack.size&&this.unhookListener()):e.debug('Trigger: Stack item matched event position "'.concat(t.position,'" has no "empty" flag match, exit.')):e.debug('Trigger: No stack item matched event position "'.concat(t.position,'", exit.'))}},{key:"triggerAdvertDisabledState",value:function(){e.debug("Event disabled processing"),this.stack=new Map}},{key:"resolveTargetElement",value:function(e){return e.parentElement&&0===e.parentElement.id.indexOf(this.WRAPPER_ELEMENT_ID_PREFIX)?e.parentElement:e}},{key:"watch",value:function(){this.stack.size?(this.processJournal(),this.stack.size?this.hookListener():e.debug("Watch not initialized, signals processed from journal.")):e.debug("Watch not initialized, no items to track.")}},{key:"processItemAction",value:function(t){var n=t.element,i=t.element.id;t.displayElement&&n.classList.contains("admngr-hidden")&&(n.classList.remove("admngr-hidden"),e.debug('Element id "'.concat(i,'" made visible.'))),t.displayElement||n.classList.contains("admngr-hidden")||(n.classList.add("admngr-hidden"),e.debug('Element id "'.concat(i,'" made hidden.'))),e.debug('Element id "'.concat(i,'" processed, no changes applied.'))}},{key:"markModifierAccomplished",value:function(e){e.signalModifier.applied=!0}},{key:"processJournal",value:function(){if(!this.watching){var e=fe.getStorage(),t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;if("state.disabled"===a.event){this.triggerAdvertDisabledState();break}"slot.positionRendered"===a.event&&this.trigger(a.data.detail)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}}},{key:"hookListener",value:function(){window.addEventListener("".concat("SmeAdManager",".").concat("state.disabled"),this.triggerAdvertDisabledState.bind(this)),window.addEventListener("".concat("SmeAdManager",".").concat("slot.positionRendered"),this.eventTrigger.bind(this)),this.watching=!0}},{key:"unhookListener",value:function(){window.removeEventListener("".concat("SmeAdManager",".").concat("state.disabled"),this.triggerAdvertDisabledState.bind(this),!1),window.removeEventListener("".concat("SmeAdManager",".").concat("slot.positionRendered"),this.eventTrigger.bind(this),!1),this.watching=!1}}])&&Be(t.prototype,n),r&&Be(t,r),e}();function We(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ge=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handlerPositionRendered=new He}var t,n,r;return t=e,(n=[{key:"add",value:function(e){var t,n,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.debug("Adding signal",e),e.signal){var o=e.signal;if("renderPosition"===o.type&&r)return this.handlerPositionRendered.add(o.position,null===(t=o.empty)||void 0===t||t,null===(i=null===(n=e.action)||void 0===n?void 0:n.display)||void 0===i||i,r.divElement,e),void this.debug("Signal added to Position render");this.debug("Unsupported signal type",e)}}},{key:"debug",value:function(e,t){i.a.log("SignalModifierHandler",e,t)}}])&&We(t.prototype,n),r&&We(t,r),e}());function qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ye(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?Xe(e):t}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qe(e,t){return(Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ze=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Ye(this,Ke(t).call(this,e,n))).adSlotsLazy=!1,i.dependentSlotsPresent=!1,i.libraryInjected=!1,i.debug("constructor()"),window.googletag.cmd=window.googletag.cmd||[],r?(i.debug("/gpt pubmatic library init"),ze.initialize(i.initializeLibrary.bind(Xe(i))),i):(i.debug("/gpt regular library init"),i.initializeLibrary(),Ye(i))}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t)}(t,e),n=t,r=[{key:"onSlotRenderedAlways",value:function(e){e.isGateCapable&&(W.setGateRequested(!0),W.runSlots(e)),fe.positionRendered(e)}},{key:"setPerformanceTrack",value:function(e){0!==window.location.host.indexOf("svet.sme")&&0!==window.location.host.indexOf("www.sme")&&0!==window.location.host.indexOf("demo-adv.sme")||"sme_title_extra_a_resp"!==e.positionName&&"side_1"!==e.positionName&&"big_1"!==e.positionName||(e.trackPerformance=!0)}},{key:"getDocLang",value:function(){return document.documentElement.lang.toLowerCase()||"sk"}}],(i=[{key:"createAdSlotFromDefinition",value:function(e){return De.createFromDefinition(e)}},{key:"getRestoreDefinition",value:function(e){return e.totalViewTime=1,e.originAdUnitPath&&(e.adUnitPath=e.originAdUnitPath),e.forceReloadPerformed=!1,e}},{key:"defineSlot",value:function(e){var n=this;if(this.debug("defineSlot()",e),e.lazy&&(this.adSlotsLazy=!0),t.setPerformanceTrack(e),e.isHiddenOnVisibleGate){if(B.adjustWrapperSize(),!j.hasPageAvailableSideSpace(this.pageContentWidth))return this.debug("STOP defining slot gtg - no available side space",e),void j.flushSizes(e);j.repopulateClientSideSizes(e,this.pageContentWidth),this.dependentSlotsPresent=!0}this.addInternalCommand((function(){e.useUserDisplayResolver&&!1===n.userDisplayResolver.showAdverts()?n.debug("STOP defining slot in googletag based on the result from displayResolver",e):(e.trackPerformance&&(e.startTime=Math.floor(performance.now())),window.googletag.cmd.push((function(){n.debug("googletagCMD: defining slot",e);var t=window.googletag.sizeMapping().addSize(window.viewPortSize,e.sizes).build();e.ref=window.googletag.defineSlot(e.adUnitPath,e.sizes,e.divId).defineSizeMapping(t).addService(window.googletag.pubads());var i=function(e){if(!e)return null;var t={},n=!0,i=!1,r=void 0;try{for(var o,a=e.split("&")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=qe(o.value.split("="),2),l=s[0],u=s[1];t[l]=void 0!==t[l]?[u].concat(t[l]):u}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return 0===Object.keys(t).length?null:t}(e.targeting);i&&(e.ref.updateTargetingFromMap(i),n.debug("googletagCMD: defining slot with targeting",i))})))}),e.positionName),this.adSlots.set(e.divId,e)}},{key:"start",value:function(){var e=this;this.debug("start()"),this.detectTargeting(),this.addInternalCommand((function(){window.googletag.cmd.push((function(){e.targeting.forEach((function(t,n){e.debug('googletagCMD: set targeting "'+n+'"="'+t+'"'),window.googletag.pubads().setTargeting(n,t)})),e.adSlotsLazy||e.dependentSlotsPresent?window.googletag.pubads().disableInitialLoad():window.googletag.pubads().enableSingleRequest(),window.googletag.enableServices(),window.googletag.pubads().addEventListener("slotRenderEnded",e.onSlotRendered.bind(e))}))}))}},{key:"display",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.debug('display() "'.concat(e,'" ').concat(n?"with force":""));var i=this.getAdSlotByDivId(e);if(null===i)return this.debug("no adSlot to display with DivId",e),null;if(i.divElement=document.getElementById(e),null===i.divElement)throw new Error("divElement should not be null");return ge.active()?(ge.render(i),null):(i.signalModifier&&Ge.add(i.signalModifier,i),i.isHiddenOnVisibleGate&&!n?(this.debug("Gate format MAY be loaded, storing slot for further GateHandler.runSlots"),W.addGateDependentSlot(i),null):(!n&&i.position.isFixedBottom()&&p.hide(i.divElement),i.lazy&&!n?(this.debug("adSlot is lazy, will be displayed on scroll"),me.add(i),null):(this.debug("displaying adSlot",i),l.update(i),this.addInternalCommand((function(){if(!i)throw new Error("adSlot should be defined");i.useUserDisplayResolver&&!1===t.userDisplayResolver.showAdverts()?t.debug("STOP processing advert in googletag based on the result from displayResolver",i):(t.debug("displaying adSlot",i),i.loadInitialized=!0,window.googletag.cmd.push((function(){if(null===i)throw new Error("adSlot should not be null");t.debug("googletagCMD: displaying adSlot with divId: "+i.divId),window.googletag.display(i.divId),t.adSlotsLazy&&window.googletag.pubads().refresh([i.ref])})),l.update(i),t.appendSlotRefresh(i))}),i.positionName),i)))}},{key:"refresh",value:function(e){var t=this;this.debug("refreshing()",e);var n=null;if("string"==typeof e){if(null===(n=this.getAdSlotByDivId(e)))return}else n=e;n.refreshAdUnitPath&&n.refreshAdUnitPath!==n.adUnitPath&&(n.originAdUnitPath=n.adUnitPath,n.adUnitPath=n.refreshAdUnitPath,n.forceReload=!0);var i=!1;if(n.isGateCapable&&W.gateWrapperRendered()&&(W.preservePlaceholderHeight(n.divElement),this.debug('Setting gate height lock to element id "'.concat(n.divId,'"')),i=!0,W.destroy()),n.size=null,n.totalViewTime=0,n.loadInitialized&&n.forceReload&&!n.forceReloadPerformed)return this.debug("force refreshing adSlot",n),n.forceReloadPerformed=!0,n.forceReload=!1,i||this.lockSlotPlaceholderHeight(n),this.destroyAdSlot(n),this.defineSlot(n),void this.display(n.divId,!0);this.debug("refreshing adSlot",n),this.addInternalCommand((function(){if(!n)throw new Error("adSlot should be defined");n.useUserDisplayResolver&&!1===t.userDisplayResolver.showAdverts()?t.debug("STOP processing advert in google tag based on the result from displayResolver",n):(t.debug("displaying adSlot",n),n.loadInitialized=!0,window.googletag.cmd.push((function(){if(!n)throw new Error("adSlot should be defined");t.debug("googletagCMD: displaying adSlot with divId"+n.divId),window.googletag.display(n.divId),window.googletag.pubads().refresh([n.ref])})),l.update(n))}),n.positionName)}},{key:"destroyAdSlot",value:function(e){var t=this;return this.debug("destroyAdSlot()",e),"object"!==Ve(e.ref)?(this.debug("Unable to destroy adSlot, hence it got no googletag reference",e),!1):(this.addInternalCommand((function(){window.googletag.cmd.push((function(){t.debug("googletagCMD: Destroying slots with googletag reference",e),window.googletag.destroySlots([e.ref])}))}),e.positionName),!0)}},{key:"destroy",value:function(e){this.debug("destroy()",e),null!==this.adRefresher&&this.adRefresher.unobserve(e),this.destroyAdSlot(e),e.label.hide(),me.detachSlot(e)}},{key:"reset",value:function(){W.reset()}},{key:"gateRenderedHandler",value:function(e){this.debug("gateRenderedHandler()",e);var t=this.getAdSlotByDivId(e);null!==t&&t.loadInitialized&&t.isGateCapable?W.runSlots(t):this.debug("gateRenderedHandler() no valid gate slot",t)}},{key:"clearTargeting",value:function(){var e=this;this.debug("Queuing targeting clear."),this.targeting.clear(),this.addInternalCommand((function(){window.googletag.cmd.push((function(){window.googletag.pubads().clearTargeting()})),e.debug("Targeting cleared.")}))}},{key:"initializeLibrary",value:function(){var e=this;this.loaded=!0,this.runInternalCommandsTrigger(),this.libraryInjected?this.debug("GoogleTag was already initialized in the main page, skipping adding scripts for gpt.js"):(Ne.placeScript("https://securepubads.g.doubleclick.net/tag/js/gpt.js",new xe("sme-ad-manager-gpt",{errorCallback:function(){e.debug("GPT script blocked/error"),window.gptBlocked=!0}})),this.libraryInjected=!0)}},{key:"onSlotRendered",value:function(e){this.debug('"slotRenderEnded" event occurred',e);var t=e.slot.getSlotElementId();this.debug("slotElementId: "+t);var n=this.getAdSlotByDivId(t);if(this.debug("adSlot by divId",n),n){if(n.trackPerformance&&n.startTime){var i=Math.floor(performance.now());this.trackStat({slot:n.positionName,action:"slotLoadTime",duration:i-n.startTime,layout:n.layoutType}),n.trackPerformance=!1}if(e.isEmpty)return this.debug("The event is empty",e),void this.onSlotRenderedEmpty(e,n);this.debug("The event is not empty",e),this.onSlotRenderedNotEmpty(e,n,t)}}},{key:"onSlotRenderedEmpty",value:function(e,n){if(null===n.divElement)throw new Error("divElement should not be null");n.updateSlotStatEmpty(),p.removePlaceholderHeightLock(n.divElement),this.hideSlot(n),t.onSlotRenderedAlways(n)}},{key:"onSlotRenderedNotEmpty",value:function(e,n,i){var r=new v(Number(e.size[0]),Number(e.size[1]));if(j.isValidSlotSizeBySlot(r,n.sizes)||(this.debug('Invalid slot size "'.concat(r.toString(),'" for position id "').concat(n.divId,'".')),r=j.extractRenderedSize(r,n)),this.updateSlotSize(n,i,r),p.centerWrapperBySize(n.divElement,r.width),p.removePlaceholderHeightLock(n.divElement,p.PLACEHOLDER_HEIGHT_LOCK_REMOVE_TIMEOUT),n.hasFluidSize()&&(n.detectFluidContent(e.size),null!==n.fluidLabel&&n.fluidLabel.toggle(),l.update(n,"isFluidContent")),n.position.isSkyLeft()&&j.moveLeftWrapper(n),n.position.isSkyPosition()&&null!==n.divElement&&p.removeEmptySize(n.divElement),this.debug("showing label for adSlot"),n.label.show(),n.forceReloadPerformed&&this.unLockSlotPlaceholderHeight(n),n.restoreRefreshTime(),n.updateSlotStatFilled(),null===n.divElement)throw new Error("divElement should not be null");n.position.isFixedBottom()&&(n.label.setOnClickDestroyAdSlotEnabled(!0),p.show(n.divElement)),p.removeOverflow(n.divElement),l.update(n),t.onSlotRenderedAlways(n)}},{key:"lockSlotPlaceholderHeight",value:function(e){if(this.debug("lockSlotPlaceholderHeight()",e),null===e.divElement)throw new Error("divElement should not be null");return e.divElement.style.height=e.divElement.clientHeight+"px",!0}},{key:"appendSlotRefresh",value:function(e){null===e.refreshAfter||0>=e.refreshAfter||(null!==this.adRefresher?this.adRefresher.observe(e):this.addToPendingObserveAdSlots(e))}},{key:"detectTargeting",value:function(){var e=window.location.hostname.substr(0,40),n=window.location.pathname.substr(0,40);if(this.targeting.set("advmdomain",e),this.targeting.set("advm_domain",e),this.targeting.set("advmurl",n),this.targeting.set("advm_url",n),this.targeting.set("lang",t.getDocLang()),void 0!==window.smeAdvertTargeting)for(var i in window.smeAdvertTargeting){var r=Object.keys(window.smeAdvertTargeting[i]);for(var o in r)this.targeting.set(r[o],window.smeAdvertTargeting[i][r[o]])}}}])&&Je(n.prototype,i),r&&Je(n,r),t}(Ce);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tt(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function it(e,t){return(it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Ze.SHORT_NAME="gtg",Ze.AD_UNIT_DEFAULT_REFRESH_SUFFIX="_r";var rt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=tt(this,nt(t).apply(this,arguments))).adspace=null,e.section=null,e.userAdspId=null,e.exclusiveUserAdspace=!0,e}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&it(e,t)}(t,e),n=t,r=[{key:"createFromDefinition",value:function(e){var n=new t(e.provider,e.positionName,e.adUnitPath,e.sizes,e.divId);return this.fillInresAdSlotFromDefinition(n,e),n}},{key:"fillInresAdSlotFromDefinition",value:function(e,t){U.fillAdSlotFromDefinition(e,t),e.adspace=T.getNumberOrNull(t,"adspace"),e.section=T.getNumberOrNull(t,"section"),e.userAdspId=T.getStringOrNull(t,"userAdspId"),e.exclusiveUserAdspace=T.getBoolean(t,"exclusiveUserAdspace",!0)}}],(i=null)&&et(n.prototype,i),r&&et(n,r),t}(U);function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function st(e,t){return!t||"object"!==ot(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dt=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=st(this,lt(t).call(this,e,n))).resizeObserver=null,i.mutationObserver=null,i.debug("constructor()"),void 0!==window.g_ntscAd?(i.markAsLoaded(),st(i)):(Ne.placeScript("https://inres.uspech.sk/js/main_ad_04c_sme.js",new xe("sme-ad-manager-inrs",{successCallback:function(){i.debug('Inres main script "main_ad_04c_sme.js" was successfully loaded'),i.markAsLoaded()}})),i)}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}(t,e),n=t,(i=[{key:"createAdSlotFromDefinition",value:function(e){return rt.createFromDefinition(e)}},{key:"defineSlot",value:function(e){this.debug("defineSlot()",e),this.adSlots.set(e.divId,e)}},{key:"start",value:function(){this.debug("start()")}},{key:"display",value:function(e,t){var n=this;this.debug("display()",e);var i=this.getAdSlotByDivId(e);if(null===i)return this.debug("no adSlot to display with DivId",e),null;if(this.debug("displaying adSlot",i),i.divElement=document.getElementById(e),null===i.divElement)throw new Error("divElement should not be null");return this.initializeObserver(),this.resizeObserver?this.resizeObserver.observe(i.divElement):this.mutationObserver&&this.mutationObserver.observe(i.divElement,{childList:!0,subtree:!0}),this.addInternalCommand((function(){if(!i)throw new Error("adSlot should be defined");i.useUserDisplayResolver&&!1===n.userDisplayResolver.showAdverts()?n.debug("STOP processing advert in g_ntscAd(INRES) based on the result from displayResolver",i):(i.loadInitialized=!0,window.g_ntscAd.insertExtAdspace(i.divId,i.adspace,null,i.section,null,i.userAdspId,i.exclusiveUserAdspace),n.debug("display internCommand executed",i),l.update(i))}),i.positionName),l.update(i),i}},{key:"destroy",value:function(e){this.debug("destroy()",e),null!==e.divElement&&e.divElement.classList.add("admngr-hidden"),e.label.hide()}},{key:"onUserLoaded",value:function(e){var t=this;this.addInternalCommand((function(){t.debug("Sending currently logged user ID ".concat(e.id," to Inres.")),window.g_ntscAd.setExternalUserId(1,e.id)}))}},{key:"initializeObserver",value:function(){this.resizeObserver||this.mutationObserver||("function"!=typeof window.ResizeObserver?"function"!=typeof window.MutationObserver||this.initializeMutationObserver():this.initializeResizeObserver())}},{key:"initializeResizeObserver",value:function(){var e=this;this.resizeObserver=new ResizeObserver((function(t,n){t.forEach((function(t){var i=t.target,r=e.getAdSlotByDivId(i.id);null!==r&&(t.contentRect.height>=50?(r.size=new v(t.contentRect.width,t.contentRect.height),l.update(r),null!==r.refreshAfter&&n.unobserve(i)):0!==t.contentRect.height||r.label.isHidden()||(r.label.hide(),n.unobserve(i)))}))}))}},{key:"initializeMutationObserver",value:function(){var e=this;this.mutationObserver=new MutationObserver((function(t){t.forEach((function(t){var n=t.target,i=e.getAdSlotByDivId(n.id);null!==i&&n.parentNode&&n.parentNode.clientHeight>=50&&(i.size=new v(n.clientWidth,n.clientHeight),i.label.show(),l.update(i))}))}))}}])&&at(n.prototype,i),r&&at(n,r),t}(Ce);function ct(e){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ft(e,t){return!t||"object"!==ct(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gt(e,t){return(gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ft(this,pt(t).apply(this,arguments))).adCode=null,e.consecutiveEmpty=0,e.filledCount=0,e.refreshInitialized=!1,e}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(t,e),n=t,r=[{key:"createFromDefinition",value:function(e){var n=new t(e.provider,e.positionName,e.adUnitPath,e.sizes,e.divId);return this.fillEtargetHBAdSlotFromDefinition(n,e),n}},{key:"fillEtargetHBAdSlotFromDefinition",value:function(e,t){U.fillAdSlotFromDefinition(e,t),e.adCode=T.getNumberOrNull(t,"adCode")}}],(i=null)&&ht(n.prototype,i),r&&ht(n,r),t}(U),yt="_fallback",bt="-fallback",mt="-wrapper-fallback",wt="etarget-hb-wrap",Et={positionName:function(e){return"".concat(e.positionName).concat(yt)},divId:function(e){return"".concat(e.divId).concat(bt)},elementWrapperId:function(e){return"".concat(e.divId).concat(mt)}},St=0<window.location.hash.indexOf("advmngrDbgETHGBFallback");var kt={positionName:"",layoutType:"",useUserDisplayResolver:!1,originAdUnitPath:"",adUnitPath:"",refreshAdUnitPath:"",sizes:[],divId:"",maxWidth:null,lazy:!1,showLabels:!1,refreshAfter:0,forceReload:!1,maxHeight:null,lazyLoadOffsetFromTop:0,dfpUrl:null,divElement:null,loadInitialized:!1,provider:null,fallback:null,targeting:null};function _t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ze.SHORT_NAME,n=e;return Ze.SHORT_NAME===t&&(n=function(e){if(!e.hasOwnProperty("adUnitPath")||!e.hasOwnProperty("sizes"))return null;var t=e;e.hasOwnProperty("originAdUnitPath")||(t.originAdUnitPath=e.adUnitPath);e.hasOwnProperty("refreshAdUnitPath")||(t.refreshAdUnitPath=e.adUnitPath+(e.adUnitPath.indexOf(Ze.AD_UNIT_DEFAULT_REFRESH_SUFFIX)>0?"":Ze.AD_UNIT_DEFAULT_REFRESH_SUFFIX));return t}(e)),n?Object.assign(kt,n):null}var At="/EtgHB/refresh";function Ot(e){return e?0<window.location.hash.indexOf("advmngrDbgETHGBRefresh")||void 0!==window.ethbRefreshAlter&&window.ethbRefreshAlter?e+1:e:null}function Ct(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e&&void 0!==e){if(t)return window.ethb.refresh(e,t),void i.a.log(At,"Performed on code ".concat(e," with argument ").concat(t));window.ethb.refresh(e),i.a.log(At,"Performed with code ".concat(e))}else i.a.log(At,"No adCode provided. Stop.")}var It="/EtgHB/init",Tt="https://etargetcdn.com/hb/1.%s.js";function Pt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=null!=n?n:null!==(t=e.adCode)&&void 0!==t?t:null;r?(window.ethb.que.push({addEvent:[[r,{bidWonData:["(function(data){ window.smeAdManager.cmd.push(function () { \n                                window.smeAdManager.mngr.biddingEnd('etghb','".concat(e.positionName,"', \n                                '").concat(e.divId,"', data); }); })(args)")]}]]}),i.a.log(It,'Appended callback for adCode "'.concat(r,'"'))):i.a.log(It,'Na adCode provided for callback definition. Stop."')}function Rt(e,t){e?(Ne.placeScript(Tt.replace("%s",e.toString()),new xe("sme-ad-manager-etghb-init",{successCallback:function(){i.a.log(It,'AdCode "'.concat(e,'" script loaded'))},errorCallback:function(){t()}})),i.a.log(It,'adcode "'.concat(e,'" script appended'))):i.a.log(It,"no adCode provided for script load")}function Lt(e){return"etarget-id-".concat(e)}function Dt(e){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xt(e,t){return(xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ft=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t){return!t||"object"!==Dt(t)&&"function"!=typeof t?jt(e):t}(this,Nt(t).call(this,e,n))).BIDDING_END_WINNER_TYPE_FALLBACK="etargetfallback",r.BIDDING_END_WINNER_TYPE_ETARGET_COLLECTION="etarget",r.debug("constructor()"),i.a.log(It,"Loading library script for etgHB.js and initializing global variables."),window.ethb=window.ethb||{},window.ethb.que=window.ethb.que||[],Ne.placeScript("https://etargetcdn.com/hb/init.js",new xe("sme-ad-manager-etghb-init")),r.loaded=!0,window.addEventListener("SmeAdManager.slot.positionRendered",r.fallbackPositionListener.bind(jt(r))),r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xt(e,t)}(t,e),n=t,o=[{key:"startPerformanceTrack",value:function(e){e.trackPerformance&&(e.startTime=Math.floor(performance.now()))}},{key:"makeRefreshAdCode",value:function(e,t){var n=Lt(t);if(!function(e,t){var n;if(void 0===e)return!1;var i=null===(n=e.parentNode)||void 0===n?void 0:n.parentNode;if(void 0===i)return!1;var r=p.appendDivElement(i,null,wt);return!!r&&!!p.appendDivElement(r,t)}(e.divElement,n))throw new Error('Unable to create refresh wrapper "'.concat(n,'".'));Pt(e,t),Rt(t,(function(){}))}},{key:"removeFallbackGateSize",value:function(e){e.fallback&&(e.fallback.sizes=e.getFallbackSizesWithoutGate())}},{key:"setRefreshTimeByCallbackSlot",value:function(e,t){0!==e.refreshAfter&&(e.refreshAfter=U.FORMAT_NAME_GATE===t?W.REFRESH_GATE_TIME:W.REFRESH_SCREEN_TIME)}}],(r=[{key:"createAdSlotFromDefinition",value:function(e){return vt.createFromDefinition(e)}},{key:"defineSlot",value:function(e){this.debug("defineSlot()",e),e.trackPerformance=!0,this.adSlots.set(e.divId,e)}},{key:"start",value:function(){this.debug("start()")}},{key:"display",value:function(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.debug("display()",e);var r=this.getAdSlotByDivId(e);if(null===r)return this.debug("no adSlot to display with DivId",e),null;if(r.divElement=document.getElementById(e),null===r.divElement)throw new Error('divElement "'.concat(e,'" should not be null'));return ge.active()?(ge.render(r),null):r.lazy&&!i?(this.debug("adSlot ethgb is lazy"),me.add(r),null):(this.addInternalCommand((function(){var e;if(!r)throw new Error("adSlot should be defined");r.useUserDisplayResolver&&!1===n.userDisplayResolver.showAdverts()?n.debug("STOP processing advert in etarget HB based on the result from displayResolver",r):(r.loadInitialized=!0,t.startPerformanceTrack(r),Pt(r),Rt(null!==(e=r.adCode)&&void 0!==e?e:null,n.scriptLoadError.bind(n)),l.update(r),null!==r.refreshAfter&&r.refreshAfter>0&&null!==n.adRefresher&&n.adRefresher.observe(r))}),r.positionName),l.update(r),r)}},{key:"destroy",value:function(e){this.debug("destroy()",e),null!==e.divElement&&e.divElement.classList.add("admngr-hidden"),e.label.hide()}},{key:"refresh",value:function(e){var t=this;this.debug("refreshing()",e);var n="string"==typeof e?this.getAdSlotByDivId(e):e;if(null!==n){if(void 0===window.ethb||"function"!=typeof window.ethb.refresh)return this.debug("adSlot ethb.refresh not available. Stopping position."),void this.addInternalCommand((function(){window.smeAdManager.mngr.addPositionToBlacklist(n.positionName)}),n.positionName);this.debug("refreshing adSlot",n),n.fallback=function(e){if(!e)return null;var t=e.adUnitPath;return t.indexOf(Ze.AD_UNIT_DEFAULT_REFRESH_SUFFIX)>0?e:(e.adUnitPath="".concat(t).concat(Ze.AD_UNIT_DEFAULT_REFRESH_SUFFIX),e)}(n.fallback),this.addInternalCommand((function(){var e;if(null===n||!n.adCode||n.useUserDisplayResolver&&!1===t.userDisplayResolver.showAdverts())t.debug("Slot not defined or without adCode or disabled by user state. Refresh stop.",n);else{t.debug("refreshing adSlot callback",n),n.loadInitialized=!0;var i=Ot(null!==(e=n.adCode)&&void 0!==e?e:null);if(i===n.adCode)return Ct(i),void l.update(n);if(Ct(n.adCode,"_r"),!n.refreshInitialized&&i){var r=Lt(i);!function(e,t){e.divElement=document.getElementById(t)}(n,r),n.refreshInitialized=!0}l.update(n)}}),n.positionName)}else this.debug("adSlot should be defined")}},{key:"biddingEnd",value:function(e,t){this.debug("/BiddingEnd callback",e);var n=null;if(null!==(n=this.getAdSlotByDivId(e)))if(this.debug("/BiddingEnd data",t),void 0!==t.winner){if(n.trackPerformance&&n.startTime){var i=Math.floor(performance.now());this.trackStat({slot:n.positionName,action:"slotLoadTime",duration:i-n.startTime,layout:n.layoutType}),n.trackPerformance=!1}if(null!==n.refreshAfter&&n.refreshAfter>0&&null!==this.adRefresher&&this.adRefresher.observe(n),this.BIDDING_END_WINNER_TYPE_FALLBACK===t.winner)return this.debug("/BiddingEnd fallback winner",n),this.renderedEmpty(n),void this.showSlotFallback(n);this.debug("/BiddingEnd etgHB winner.",n);var r=this.getBidWinner(t.data.bids,t.winner);r?(this.hideSlotFallback(n),this.renderedNotEmpty(n,e,new v(Number(r.width),Number(r.height)))):this.debug("/BiddingEnd No bid winner resolved.")}else this.debug("/BiddingEnd without winner, quit!",e);else this.debug("/BiddingEnd adSlot not found",e)}},{key:"fallbackPositionListener",value:function(e){if(this.debug("fallbackPositionListener() with event",e),this.initialized)if(e instanceof CustomEvent&&e.detail&&e.detail instanceof Z){var n=e.detail;if(null!==n.parentDivId){var i=this.getAdSlotByDivId(n.parentDivId);null!==i&&t.SHORT_NAME===i.provider.toString()?(fe.positionRendered(i,n.empty,n.empty?null:new v(n.width,n.height),n.format),n.empty?this.debug('fallbackPositionListener() data empty render position "'.concat(n.position,'" - no attribute changes to ').concat(i.positionName)):(t.setRefreshTimeByCallbackSlot(i,n.format),i.updateSlotStatFilled(),l.update(i),this.debug("fallbackPositionListener() render non-empty for parent. Update restore time and consecutive counter.",i))):this.debug('fallbackPositionListener() no matching adSlot parent for divId "'.concat(n.parentDivId,'" of etghb provider'))}else this.debug("fallbackPositionListener() data without parent slot",n)}else this.debug("fallbackPositionListener() unhandled event",e);else this.debug("fallbackPositionListener() provider not yet initialized, event")}},{key:"renderedNotEmpty",value:function(e,n,i){if(this.updateSlotSize(e,n,i),this.debug("showing label for adSlot"),e.label.show(),e.forceReloadPerformed&&this.unLockSlotPlaceholderHeight(e),e.restoreRefreshTime(),e.updateSlotStatFilled(),p.setIframeBlockStyle(e.divElement),null===e.divElement)throw new Error("divElement should not be null");this.displayElement(e),e.isGateCapable&&(W.setGateRequested(!0),W.forceGateAwareSlots(),t.removeFallbackGateSize(e)),fe.positionRendered(e),l.update(e)}},{key:"renderedEmpty",value:function(e){if(null===e.divElement)throw new Error("divElement should not be null");e.updateSlotStatEmpty(),this.hideSlot(e)}},{key:"showSlotFallback",value:function(e){var t,n,i=this;if(null!==e.fallback){var r=Et.positionName(e),o=Et.divId(e),a=Et.elementWrapperId(e);if(p.appendDivElement(null===(n=null===(t=e.divElement)||void 0===t?void 0:t.parentNode)||void 0===n?void 0:n.parentNode,a)){var s=ye.has(r,o);s||this.defineFallbackSlot(e,r,o),this.addInternalCommand((function(){i.debug("/BiddingEnd-showFallback place/refresh slot called with [positionName, divId]",[r,o]),s?window.smeAdManager.mngr.refresh(r,o):window.smeAdManager.mngr.placeSlot(r,a)}),r),this.debug('/BiddingEnd-showFallback slot "'.concat(e.positionName,'" with fallback "').concat(r,'"'))}else this.debug("/BiddingEnd-showFallback unable to create slot fallback for divId ".concat(o," "))}else this.debug("/BiddingEnd-showFallback no fallback defined",e)}},{key:"hideSlotFallback",value:function(e){var t=Et.positionName(e);t?(this.addInternalCommand((function(){window.smeAdManager.mngr.hideElementByPosition(t)}),e.positionName),this.debug('/BiddingEnd Hide fallback call on slot "'.concat(e.positionName,'" with fallback position "').concat(t,'"'))):this.debug("/BiddingEnd Unable to obtain fallbackPosition name for hide.",e)}},{key:"defineFallbackSlot",value:function(e,t,n){var i=this;if(this.debug("/defineFallbackSlot start"),ye.getFirstAdSlot(t))this.debug("/defineFallbackSlot slot already defined");else if(e.fallback){var r,o=(r=e.fallback,St?new R({adUnitPath:"/43112356/test_pr/dRectangleAtst_100",refreshAdUnitPath:"/43112356/test_pr/dRectangleAtst_100",sizes:[U.FORMAT_NAME_FLUID]}):r);if(o){var a=_t(o=Object.assign(o,{positionName:t,layoutType:e.layoutType,useUserDisplayResolver:e.useUserDisplayResolver,divId:n,showLabels:e.showLabels,lazy:!1,refreshAfter:0,parentSlotDivId:e.divId,isGateCapable:e.isGateCapable,isHiddenOnVisibleGate:e.isHiddenOnVisibleGate}));a?(this.addInternalCommand((function(){window.smeAdManager.mngr.defineSlot("gtg",a),i.debug('/defineFallbackSlot internal command call on slot "'.concat(t,'"'))}),t),this.runInternalCommandsForPosition(t)):this.debug("/defineFallbackSlot slot definition failed for attributes",o)}else this.debug("/defineFallbackSlot no fallback attribute")}else this.debug("/defineFallbackSlot no fallback present present",e)}},{key:"getBidWinner",value:function(e,t){if(!e||0===e.length)return this.debug("/BiddingEndWinner No bids found!"),null;for(var n=0;n<e.length;n++)if(e[n].bidderCode===t)return e[n];return 1===e.length?e[0]:t!==this.BIDDING_END_WINNER_TYPE_ETARGET_COLLECTION&&t.indexOf(this.BIDDING_END_WINNER_TYPE_ETARGET_COLLECTION)>-1?this.getBidWinner(e,this.BIDDING_END_WINNER_TYPE_ETARGET_COLLECTION):(this.debug("/BiddingEndWinner Unable to determine winner!"),null)}},{key:"scriptLoadError",value:function(){this.debug("Etarget HB script blocked/error"),this.trackStat({action:"slotScriptLoadError"}),window.gptBlocked&&this.trackStat({action:"slotScriptLoadError"},"gtg")}}])&&Ut(n.prototype,r),o&&Ut(n,o),t}(Ce);Ft.SHORT_NAME="etghb";function zt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Mt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Bt=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.CUSTOM_PARAMS_URL_KEY="cust_params"}var t,n,i;return t=e,i=[{key:"getObjectQueryAsUrlQuery",value:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}}],(n=[{key:"getQueryParameter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1?arguments[1]:void 0;t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),i=n.exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}},{key:"getSanitizedUrl",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=null;if(0<t.indexOf("#")&&(!1===i&&(r=t.substr(t.indexOf("#"))),t=t.substr(0,t.indexOf("#"))),0<t.indexOf("?")){var o={};for(var a in n){var s=this.getQueryParameter(t,n[a]);null!==s&&(o[n[a]]=s)}t=t.substr(0,t.indexOf("?")),0<Object.keys(o).length&&(t=t+"?"+e.getObjectQueryAsUrlQuery(o))}return i||null===r||(t+=r),t}},{key:"addCustomParamsToUrl",value:function(e,t){if(-1!==e.indexOf(this.CUSTOM_PARAMS_URL_KEY))return e;var n,i=zt(t),r=[];if(0===i.length)return e;for(n=0;n<i.length;n++)r.push(i[n][0]+"="+i[n][1]);return e+"&"+this.CUSTOM_PARAMS_URL_KEY+"="+encodeURIComponent(r.join("&"))}}])&&Mt(t.prototype,n),i&&Mt(t,i),e}());function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Gt(e,t){return!t||"object"!==Ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qt(e){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vt(e,t){return(Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Gt(this,qt(t).apply(this,arguments))).dfpUrl=null,e.playOffset=null,e.resumeOffset=null,e.pauseOffset=null,e.autoplay=!1,e.floating=!1,e.libraryId=null,e}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}(t,e),n=t,r=[{key:"createFromDefinition",value:function(e){var n=new t(e.provider,e.positionName,e.adUnitPath,e.sizes,e.divId);return this.fillDfpVideoAdSlotFromDefinition(n,e),n}},{key:"fillDfpVideoAdSlotFromDefinition",value:function(e,t){U.fillAdSlotFromDefinition(e,t),e.dfpUrl=T.getStringOrNull(t,"dfpUrl"),e.playOffset=T.getNumberOrNull(t,"playOffset"),e.resumeOffset=T.getNumberOrNull(t,"resumeOffset"),e.pauseOffset=T.getNumberOrNull(t,"pauseOffset"),e.autoplay=T.getBoolean(t,"autoplay",!1),e.floating=T.getBoolean(t,"floating",!1),e.libraryId=T.getStringOrNull(t,"libraryId")}}],(i=null)&&Wt(n.prototype,i),r&&Wt(n,r),t}(De);function Yt(e){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xt(e){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zt(e,t){return(Zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $t=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=function(e,t){return!t||"object"!==Yt(t)&&"function"!=typeof t?Qt(e):t}(this,Xt(t).call(this,e,n))).adSlotsLazy=!1,i.adSlotsToBuild=[],i.loaded=!0,i.debug("constructor()"),document.addEventListener("sme_admanager",i.videoFallbackListener.bind(Qt(i))),document.addEventListener("SmeAdManager.videoManager.library",i.libraryReady.bind(Qt(i))),i}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zt(e,t)}(t,e),n=t,(i=[{key:"createAdSlotFromDefinition",value:function(e){return Jt.createFromDefinition(e)}},{key:"defineSlot",value:function(e){var t=this;this.debug("[dfpv] defineSlot()",e),e.lazy&&(this.adSlotsLazy=!0),this.addInternalCommand((function(){if(null===e.divElement&&e.divId&&(e.divElement=document.getElementById(e.divId)),null===e.divElement)return t.debug('[dfpv] STOP "'+e.divId+'" ; divID issue'),void t.debug("[dfpv] STOP ; divElement should not be null",e);if(e.useUserDisplayResolver&&!1===t.userDisplayResolver.showAdverts())return e.divElement.classList.add("sme-video-ad-hidden"),void t.debug("[dfpv] STOP defining slot in dfpVideo based on the result from displayResolver",e);if(e.divElement.classList.remove("sme-video-ad-hidden"),t.debug("[dfpv] unhiding element",e.divElement),void 0===window.smeVideoAdvert)t.debug("[dfpv] defineSlot undefined lib",e),t.addSlotsToBuild(e);else{t.debug("[dfpv] defineSlot LazyDisplayFactory add",e);var n={all:i=i||new Map,on:function(e,t){var n=i.get(e);n?n.push(t):i.set(e,[t])},off:function(e,t){var n=i.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):i.set(e,[]))},emit:function(e,t){var n=i.get(e);n&&n.slice().map((function(e){e(t)})),(n=i.get("*"))&&n.slice().map((function(n){n(e,t)}))}};t.bindEvents(n,e),window.smeVideoAdvert.setEventSubscriber(n),e.dfpUrl=t.getDfpUrlWithTargeting(e),me.add(e,(function(){return window.smeVideoAdvert.init({dfpUrl:e.dfpUrl,elementContainerId:e.divId,lazyLoad:e.lazy,initAdOffset:e.lazyLoadOffset,debug:!0,playAdOffset:e.playOffset,resumeAdOffset:e.resumeOffset,pauseAdOffset:e.pauseOffset,forceImmediatePlay:e.autoplay,floating:e.floating,libraryId:e.libraryId})}))}var i}),e.positionName),this.adSlots.set(e.divId,e)}},{key:"start",value:function(){this.debug("start()")}},{key:"display",value:function(e){this.debug("display()",e);var t=this.getAdSlotByDivId(e);return null===t?(this.debug("no adSlot to display with DivId",e),null):(this.debug("displaying adSlot",t),t.divElement=document.getElementById(e),!1===this.userDisplayResolver.showAdverts()&&t.divElement&&t.divElement.classList.add("sme-video-ad-hidden"),l.update(t),t)}},{key:"addSlotsToBuild",value:function(e){this.debug("[dfpv] addSlotsToBuild adding",e),-1<this.adSlotsToBuild.indexOf(e.divId)||(this.adSlotsToBuild.push(e.divId),this.debug("[dfpv] addSlotsToBuild added",e))}},{key:"getDfpUrlWithTargeting",value:function(e){return Bt.addCustomParamsToUrl(e.dfpUrl,this.targeting)}},{key:"libraryReady",value:function(e){if(this.debug("[dfpv] libraryReady",e),e instanceof CustomEvent)if(e.detail||e.detail.state)if("ready"===e.detail.state){this.debug("[dfpv] libraryReady ready",this.adSlotsToBuild);var t=this.adSlotsToBuild;this.adSlotsToBuild=[];var n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.debug("[dfpv] libraryReady checking",s);var l=this.getAdSlotByDivId(s);if(null===l||null===l.dfpUrl)return void this.debug("[dfpv] libraryReady check failed",l);this.debug("[dfpv] libraryReady rerun defineSlot",l),this.defineSlot(l)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}else this.debug("[dfpv] libraryReady not ready",e.detail.state);else this.debug("[dfpv] libraryReady no detail",e);else this.debug("[dfpv] libraryReady no CustomEvent",e)}},{key:"videoFallbackListener",value:function(e){if(e instanceof CustomEvent&&(e.detail||e.detail.elementId)){var t=e.detail.elementId,n=this.getAdSlotByDivId(t);if(null!==n&&null!==n.dfpUrl){var i=Bt.getQueryParameter(n.dfpUrl,"iu");if(null!==i){var r="drectanglea";"original"!==n.layoutType&&(r="mrectanglea");var o=i.replace("varticlea",r),a=window.smeAdManager.mngr.getProvider("gtg"),s=new De(a,n.positionName,o,[[468,60],[600,400],[300,250],[580,400],[336,280]],n.divId+"-fallback-video");s.layoutType=n.layoutType,s.useUserDisplayResolver=n.useUserDisplayResolver,s.refreshAdUnitPath=o+"_r",s.maxWidth=0,s.lazy=n.lazy,s.lazyLoadOffset=n.lazyLoadOffset,s.refreshAfter=0,a.defineSlot(s),a.display(s.divId,!1)}else this.debug("[dfpv] cannot obtain original ad id (iu url query)",n.dfpUrl)}}}},{key:"bindEvents",value:function(e,t){var n=this;e.on("*",(function(e,i){n.debug("[dfpv] PLAYER events",[e,i]),"stateChange"===e&&"string"!=typeof i&&fe.videoEvent(t,i.state)}))}}])&&Kt(n.prototype,i),r&&Kt(n,r),t}(Ce);function en(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tn(e){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rn(e,t){return!t||"object"!==tn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function on(e){return(on=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function an(e,t){return(an=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rn(this,on(t).call(this,"SportNet",/sportnet.(sme|smestaging).sk/g))}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&an(e,t)}(t,e),n=t,(i=[{key:"locationQueryParams",value:function(){return["competitionId","part","partId","tableView","q","seasonId","page","sutaz","year","date","live"]}}])&&nn(n.prototype,i),r&&nn(n,r),t}(function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.URL_HOST_MATCH=n;var i=window.location.host;this.active=null!==this.URL_HOST_MATCH&&null!==i.match(this.URL_HOST_MATCH)}var t,n,i;return t=e,(n=[{key:"isActive",value:function(){return this.active}},{key:"getName",value:function(){return this.name}},{key:"locationQueryParams",value:function(){return null}}])&&en(t.prototype,n),i&&en(t,i),e}());function ln(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var un=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=new sn,this.client.isActive()?e.debug("SportNet client matched"):(e.debug("No client matched."),this.client=null)}var t,n,r;return t=e,r=[{key:"debug",value:function(e,t){i.a.log("/ClientSetup",e,t)}}],(n=[{key:"getLocationQueryParams",value:function(t){var n,i,r=null===(n=this.client)||void 0===n?void 0:n.locationQueryParams();return e.debug('Location query params extended by client "'.concat(null===(i=this.client)||void 0===i?void 0:i.getName(),'".'),r),null!=r?r:t}}])&&ln(t.prototype,n),r&&ln(t,r),e}());function dn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var cn=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.href="",this.queryWhitelist=["page","q"],this.isUrlHashNavigationEnabled=!1,this.queryWhitelist=un.getLocationQueryParams(this.queryWhitelist)}var t,n,r;return t=e,r=[{key:"debug",value:function(e,t){i.a.log("Location",e,t)}}],(n=[{key:"setUrlHashNavigationEnabled",value:function(e){this.isUrlHashNavigationEnabled=e}},{key:"setCurrentLocation",value:function(){this.href=window.location.href,e.debug("Current href",this.href)}},{key:"getCurrentLocation",value:function(){return window.location.href}},{key:"isUrlNavigated",value:function(t){if(e.debug('Validating navigated destination: "'+t+'"'),t!==this.getCurrentLocation())return e.debug('Destination: "'+t+'" does not match current location "'+this.getCurrentLocation()+'"'),!1;var n=!this.isUrlHashNavigationEnabled,i=Bt.getSanitizedUrl(t,this.queryWhitelist,n),r=Bt.getSanitizedUrl(this.href,this.queryWhitelist,n);return e.debug('Source: "'+r+'", destination: "'+i+'"'),i!==r}}])&&dn(t.prototype,n),r&&dn(t,r),e}());function hn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._rightLabel=null,this._rightUrl=null,this._leftLabel=null,this._leftUrl=null,this._rightLabel=t.rightLabel,this._rightUrl=t.rightUrl,this._leftLabel=t.leftLabel,this._leftUrl=t.leftUrl}var t,n,i;return t=e,(n=[{key:"rightLabel",get:function(){return this._rightLabel}},{key:"rightUrl",get:function(){return this._rightUrl}},{key:"leftLabel",get:function(){return this._leftLabel}},{key:"leftUrl",get:function(){return this._leftUrl}}])&&hn(t.prototype,n),i&&hn(t,i),e}();function pn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var gn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elementIdSuffix="-promo-label",this.wrapperClassList=["artemis-promo-labels","admngr-hidden"],this.config=t}var t,n,i;return t=e,i=[{key:"replaceAllOccurrence",value:function(e,t,n){return e.replace(new RegExp(t,"g"),n)}}],(n=[{key:"getElement",value:function(t){var n=document.createElement("div");if(n.id=t+this.elementIdSuffix,this.wrapperClassList.forEach((function(e){n.classList.add(e)})),this.config.leftLabel&&!this.config.leftUrl){var i='    <span class="admngr-c-black-50">%label%</span>';i=e.replaceAllOccurrence(i,"%label%",this.config.leftLabel),n.innerHTML+=i}if(this.config.rightLabel&&this.config.rightUrl){var r='    <span class="admngr-promo-close-wrap">        <a href="%url%" class="artemis-promo-close">            <svg width="14px" height="14px" xmlns="http://www.w3.org/2000/svg" viewBox="217 217 14 14" enable-background="new 217 217 14 14">                <title>Hide</title>                <path class="admngr-promo-close-c-svg-path" d="M224.4 224l6.5-6.5c.1-.1.1-.3 0-.4s-.3-.1-.4 0l-6.5 6.5-6.5-6.5c-.1-.1-.3-.1-.4 0s-.1.3 0 .4l6.5 6.5-6.5 6.5c-.1.1-.1.3 0 .4.1.1.1.1.2.1s.1 0 .2-.1l6.5-6.5 6.5 6.5c.1.1.1.1.2.1s.2 0 .2-.1c.1-.1.1-.3 0-.4l-6.5-6.5z"></path>            </svg>        </a>        <a class="artemis-promo-link-2" href="%url%"><span class="admngr-c-black-50">%label%</span></a>    </span>';r=e.replaceAllOccurrence(r,"%label%",this.config.rightLabel),r=e.replaceAllOccurrence(r,"%url%",this.config.rightUrl),n.innerHTML+=r}return n}}])&&pn(t.prototype,n),i&&pn(t,i),e}();function vn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var yn=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.labelConfig=null,this.labelElement=null,this.providerClass={gtg:"js-advm-provider-dfp"}}var t,n,r;return t=e,(n=[{key:"setupLabel",value:function(e){this.labelConfig=new fn(e)}},{key:"placeSlot",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.providerClass.hasOwnProperty(n))throw new Error('Slot Placeholder - unsupported provider "'.concat(n,'"'));var r=document.getElementById(t);if(null!==r){var o=this.getLabelElement();null!==o&&i&&(r.appendChild(o.getElement(e)),this.debug("/PlaceSlot label html put.",[e,t])),r.appendChild(this.getSlotElement(e,n)),this.debug("/PlaceSlot slot html put.",e)}else this.debug("Target element not found",t)}},{key:"getSlotElement",value:function(e,t){var n=document.createElement("div");return n.id=e,n.classList.add(this.providerClass[t]),n}},{key:"getLabelElement",value:function(){return null===this.labelConfig?null:null!==this.labelElement?this.labelElement:this.labelElement=new gn(this.labelConfig)}},{key:"debug",value:function(e,t){i.a.log("/SlotPlaceholder",e,t)}}])&&vn(t.prototype,n),r&&vn(t,r),e}());function bn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var mn,wn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._consentAwait=null,this._tcfapiAwait=null,this._consentAwaitFilled=!1,this._tcfapiAwaitFilled=!1,this.data=t,this.resolveData()}var t,n,i;return t=e,(n=[{key:"setConsentAwaitFilled",value:function(e){this._consentAwaitFilled=e}},{key:"setTcfapiAwaitFilled",value:function(e){this._tcfapiAwaitFilled=e}},{key:"resolveData",value:function(){null!==this.data&&this.data.hasOwnProperty("consentAwait")&&(this._consentAwait=this.data.consentAwait,!0===this._consentAwait&&(this._tcfapiAwait=!0))}},{key:"consentAwait",get:function(){return!0===this._consentAwait}},{key:"tcfapiAwait",get:function(){return!0===this._tcfapiAwait}},{key:"isConsentAwaitFilled",get:function(){return this._consentAwaitFilled}},{key:"isTcfapiAwaitFilled",get:function(){return this._tcfapiAwaitFilled}},{key:"valid",get:function(){return null!==this._consentAwait}}])&&bn(t.prototype,n),i&&bn(t,i),e}();function En(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Sn=new((mn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"notify",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i={detail:{success:t,message:null!=n?n:""}};window.dispatchEvent(new CustomEvent(e.EVENT_NAME,i))}}],(n=[{key:"notifySuccess",value:function(){e.notify(!0,"ok")}},{key:"notifyDenied",value:function(t){e.notify(!1,t)}}])&&En(t.prototype,n),i&&En(t,i),e}()).EVENT_NAME="SmeAdManager.state.reloaded",mn);function kn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _n=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"loadProvider",value:function(t,n){"id5"===t&&(function(e){window.ID5EspConfig={partnerId:e}}(parseInt(n)),e.debug('Id5 provider with id "'.concat(n,'" initialized')))}},{key:"debug",value:function(e,t){i.a.log("IdentityLoader",e,t)}}],(n=[{key:"init",value:function(t){if(t.esp){var n=t.provider;n.length&&(e.debug("Initializing ESP providers."),n.forEach((function(t){e.loadProvider(t.key,t.id)})))}}}])&&kn(t.prototype,n),r&&kn(t,r),e}());function An(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var On=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.VERSION="2.9.3b",this.providers=new Map,this.pageLayoutType=null,this.pageContentWidth=null,this.initialized=!1,this.providerRequirement=null,this.blocked=!1,this.positionBlacklist=new Set,this.pausedPositions=new Set,this.adRefresher=null,this.predefinedAdSlotDefinitions=new Map,this.reEnqueueCount=0,this.MAX_RE_ENQUEUE_COUNT=50,this.debug("Version ".concat(this.VERSION)),this.userDisplayResolver=t,window.addEventListener("SmeAdManager.gateRendered",this.gateRenderedHandler.bind(this)),window.addEventListener("SmeAdManager.state.reload",this.stateReloadHandler.bind(this)),"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",this.processCmds.bind(this)),window.dispatchEvent(new CustomEvent("SmeAdManager.managerLoad",{}))}var t,n,r;return t=e,(n=[{key:"init",value:function(e){return this.initialized?(this.debug("init() ignored, already initialized"),!1):(this.initialized=!0,this.debug("init()",e),cn.setCurrentLocation(),e.hasOwnProperty("spaNavigation")&&(cn.setUrlHashNavigationEnabled(e.spaNavigation),this.userDisplayResolver.setSpaEnabled(e.spaNavigation),B.setMultipleAppendEnabled(!0)),this.pageLayoutType=e.pageLayoutType,this.resolvePageContentWidth(e.pageContentWidth),e.hasOwnProperty("userTokenUpdateUrl")&&this.userDisplayResolver.setUserTokenUpdateUrl(e.userTokenUpdateUrl),e.hasOwnProperty("consentAwait")&&this.userDisplayResolver.setConsentAwait(e.consentAwait),e.hasOwnProperty("consentResolve")&&this.userDisplayResolver.setConsentResolve(e.consentResolve),e.hasOwnProperty("providerRequirement")&&(this.providerRequirement=e.providerRequirement),e.hasOwnProperty("label")&&yn.setupLabel(e.label),e.hasOwnProperty("cy")&&o.setData(e.cy),e.hasOwnProperty("pwt")&&ze.setup(e.pwt),e.hasOwnProperty("resourcePlacementSelector")&&Ne.setup(e.resourcePlacementSelector),e.hasOwnProperty("identity")&&_n.init(e.identity),document.cookie.indexOf(e.debugCookieName+"="+e.debugToken)>=0&&(this.debug("enabling DebugBox"),l.enable(e.debugBoxCssUrl)),document.cookie.indexOf(e.debugPreview.cookieName+"="+e.debugPreview.token)>=0&&(this.debug("enabling Placement Preview"),ge.enable(e.debugPreview.cssUrl)),this.userDisplayResolver.userResolvingActive()&&this.userDisplayResolver.isConsentResolvingEnabled()&&this.setInternalCommandProvidersExecutionPaused(!0),window.dispatchEvent(new CustomEvent("SmeAdManager.initialized",{})),!0)}},{key:"setTargeting",value:function(e,t,n){if(this.debug("setTargeting() for "+e+': "'+t+'" = "'+n+'"'),!this.initialized)throw new Error("init() must be called first");var i=this.providers.get(e);if(!i)throw new Error('Provider "'.concat(e,'" is not registered.'));i.setTargeting(t,n)}},{key:"setTargetingMap",value:function(e,t){var n=this;this.debug("setTargeting() for "+e+" with map",t),t.forEach((function(t,i){n.setTargeting(e,i,t)}))}},{key:"getTargeting",value:function(e){if(!this.initialized)throw new Error("init() must be called first");var t=this.providers.get(e);if(!t)throw new Error('Provider "'.concat(e,'" is not registered.'));return t.getTargeting()}},{key:"initServices",value:function(){var e=this;if(this.debug("initServices()"),!this.initialized)throw new Error("init() must be called first");if(ye.resolve(),window.addEventListener("SmeAdManager.advert.destroy",this.onAdSlotDestroyRequest.bind(this)),!1===this.userDisplayResolver.userResolvingActive())return this.debug("Immediately initializing ad services - user state resolving (consent or premium subscription) are not required."),this.initAdServices(),void this.userDisplayResolver.ready();if(window.addEventListener("SmeConsent.stateChange",this.onConsentStateEventHandler.bind(this)),this.userDisplayResolver.preActivateUserResolving(),this.userDisplayResolver.userDataResolved()){var t=this.userDisplayResolver.showAdverts(),n=this.userDisplayResolver.user;return n&&this.userLoaded(n),!1===t||null===t?(this.debug("Pausing execution of internal commands in providers because user should not see any ads.",t),this.setInternalCommandProvidersExecutionPaused(!0),!1===t&&this.userDisplayResolver.propagateDisabledState()):(this.setInternalCommandProvidersExecutionPaused(!1),this.debug("Ads should be displayed - initializing ad services"),this.initAdServices()),void this.userDisplayResolver.ready()}this.debug("UserResolver - pausing execution of internal commands in providers and waiting for user data"),this.setInternalCommandProvidersExecutionPaused(!0),this.userDisplayResolver.retrieveUserData((function(){e.triggerSuccessUserRetrieve()}),(function(){e.debug("UserResolver - callback - (some) loading user info provider failed"),!0===e.userDisplayResolver.userDataResolved()&&e.debug("UserResolver - callback - all loading user info provider failed, ads will stay not processed"),e.userDisplayResolver.ready(),e.userDisplayResolver.propagateDisabledState()}))}},{key:"addProvider",value:function(e,t){if(this.debug("addProvider("+e+", "+t+")"),!this.initialized)throw new Error("init() must be called first");if(this.providers.has(e))this.debug('provider with name "'+e+'" IGNORED. Provider with same name already created.');else{var n;switch(t){case"GoogleTagProvider":n=new Ze(e,this.userDisplayResolver,ze.enabled);break;case"InresProvider":n=new dt(e,this.userDisplayResolver);break;case"EtargetHBProvider":n=new Ft(e,this.userDisplayResolver);break;case"DfpVideoProvider":n=new $t(e,this.userDisplayResolver);break;default:throw new Error('Provider with type "'.concat(t,'" does not exist.'))}if(n.setPageContentWidth(h.getContentWidth()),null!==this.providerRequirement&&this.providerRequirement.hasOwnProperty(e)){var i=new wn(this.providerRequirement[e]);this.debug('Provider "'+e+'" has '+(i.valid?"valid":"invalid")+" requirements",i),i.valid&&n.setRequirements(i)}this.providers.set(e,n),this.pausedPositions.forEach((function(e){return n.pauseInternalCommandsForPosition(e)}))}}},{key:"getProvider",value:function(e){var t=this.providers.get(e);if(!t)throw new Error('Provider with name "'.concat(e,'" does not exist.'));return t}},{key:"predefineSlot",value:function(e){if(!e.positionName)throw new Error('Attribute "positionName" is required in adSlotDefinition for method "predefineSlot"');var t=["positionName","maxHeight"];Object.keys(e).forEach((function(e){if(!t.includes(e))throw new Error('Key "'.concat(e,'" is not allowed to be used as adSlotDefinitions parameter in "predefineSlot", allowed only: "').concat(t.join(),'"'))})),this.predefinedAdSlotDefinitions.set(e.positionName,e),this.providers.forEach((function(t){t.getAdSlots("positionName:"+e.positionName).forEach((function(t){t.applyDefinition(e),j.filterSlotSizes(t),l.update(t)}))}))}},{key:"defineSlot",value:function(e,t){if(this.debug("defineSlot() for "+e,t),!this.initialized)throw new Error("init() must be called first");if(null===t.layoutType||""===t.layoutType||t.layoutType===this.pageLayoutType)if(this.positionBlacklist.has(t.positionName))this.debug("adSlot define IGNORED. adSlot.positionName: "+t.positionName+" is on the position blacklist");else{var n=this.providers.get(e);if(!n)throw new Error('Provider "'.concat(e,'" is not registered.'));this.predefinedAdSlotDefinitions.has(t.positionName)&&(this.debug("adSlotDefinition is overridden by predefined adSlotDefinition",this.predefinedAdSlotDefinitions.get(t.positionName)),t=Object.assign(t,this.predefinedAdSlotDefinitions.get(t.positionName))),t.provider=n;var i=t.provider.createAdSlotFromDefinition(t);j.filterSlotSizes(i),"dfpv"!==e?ye.addAdSlot(i,t):i.provider.defineSlot(i)}else this.debug("adSlot IGNORED. adSlot.layoutType: "+t.layoutType+" differs from pageLayoutType "+this.pageLayoutType)}},{key:"gateRenderedHandler",value:function(e){if(this.debug("gateRenderedHandler() with event",e),!this.initialized)throw new Error("init() must be called first");if(e instanceof CustomEvent){if(!e.detail&&!e.detail.providerName&&!e.detail.divId)throw new Error("gate render must be called with event.detail");var t=e.detail.divId,n=e.detail.providerName;if(this.debug('gateRenderedHandler() with divId: "'+t+'"and providerName: "'+n+'" requested'),Ze.SHORT_NAME===n){var i=this.providers.get(n);if(!i)throw new Error('Provider "'.concat(n,'" is not registered.'));i.gateRenderedHandler(t)}else this.debug('gateRenderedHandler (divId: "'+t+'") can only be handled by provider "gtg" provider; "'+n+'" requested instead')}}},{key:"stateReloadHandler",value:function(e){if(this.debug("stateReloadHandler() with event",e),!this.initialized)return this.debug("reload handler called before init(), nothing to handle, STOP"),void Sn.notifyDenied("Called before init.");if(e instanceof CustomEvent){if(!e.detail&&!e.detail.destinationUrl)throw Sn.notifyDenied("Missing destination uri."),new Error("stateReloadHandler must be called with event.detail");if(this.debug("reload handler called with destinationUrl",e.detail.destinationUrl),!cn.isUrlNavigated(e.detail.destinationUrl))throw this.debug("stateReloadHandler - invalid navigation"),Sn.notifyDenied("Invalid navigation - no url change detected."),new Error("stateReloadHandler must be called with within a valid page navigation");cn.setCurrentLocation(),this.flushManagerState(),Sn.notifySuccess()}else Sn.notifyDenied("Invalid event type.")}},{key:"start",value:function(e){if(!this.initialized)throw new Error("init() must be called first");this.debug("start("+e+")");var t=this.providers.get(e);if(!t)throw new Error('Provider "'.concat(e,'" is not registered.'));t.start()}},{key:"display",value:function(e,t,n){if(!this.initialized)return this.reEnqueue((function(){window.smeAdManager.mngr.display(e,t,n)})),void this.debug("init() must be called first");if(this.debug("display(".concat(e,", ").concat(t,", ").concat(n,")")),"dfpv"===e||ye.has(t,n))if(this.positionBlacklist.has(t))this.debug('adSlot display() IGNORED. adSlot.positionName: "'+t+'" is on the position blacklist');else{var i=this.providers.get(e);if(!i)throw new Error('Provider "'.concat(e,'" is not registered.'));i.display(n)}}},{key:"refresh",value:function(e,t){if(this.initialized){var n=Ze.SHORT_NAME;if(this.debug("extern refresh(".concat(n,", ").concat(e,", ").concat(t,")")),this.positionBlacklist.has(e))this.debug('adSlot refresh() IGNORED. "'.concat(e,'" is on the position blacklist'));else{var i=this.providers.get(n);if(!i)throw new Error('Provider "'.concat(n,'" is not registered.'));i.refresh(t)}}else this.debug("init() must be called first")}},{key:"block",value:function(){this.debug("block() - all commands are now blocked from executing."),this.blocked=!0}},{key:"unblock",value:function(){this.blocked=!1,this.debug("unblock() - all commands are now unblocked, processing stacked commands."),this.processCmds()}},{key:"addPositionToBlacklist",value:function(e){this.debug("addPositionToBlacklist("+e+")"),this.positionBlacklist.add(e),this.destroyByPositionName(e)}},{key:"pausePosition",value:function(e){this.pausedPositions.add(e),this.providers.forEach((function(t){return t.pauseInternalCommandsForPosition(e)}))}},{key:"unpausePosition",value:function(e){this.pausedPositions.delete(e),this.providers.forEach((function(t){return t.runInternalCommandsForPosition(e)}))}},{key:"restoreDefinition",value:function(e){if(!this.initialized)throw new Error("/restoreDefinition init() must be called first.");var t=Ze.SHORT_NAME;if(this.debug("/restoreDefinition start for position ".concat(t)),this.positionBlacklist.has(e))this.debug("/restoreDefinition ignored. Position blacklisted.",e);else{var n=this.providers.get(t);if(!n)throw new Error('Provider "'.concat(t,'" is not registered.'));var i=ye.getFirstAdSlot(e);if(null===i)throw new Error('Adslot for position "'.concat(e,'" is not defined.'));i=n.getRestoreDefinition(i),n.defineSlot(i)}}},{key:"placeSlot",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.initialized)throw new Error("/PlaceSlot init() must be called first.");var i=Ze.SHORT_NAME;if(this.debug("/PlaceSlot start.",[i,e,t,n]),this.positionBlacklist.has(e))this.debug("/PlaceSlot ignored. Position blacklisted.",e);else{var r=this.providers.get(i);if(!r)throw new Error('Provider "'+i+'" is not registered.');var o=ye.getFirstAdSlot(e);if(null!==o)return o.loadInitialized||yn.placeSlot(o.divId,t,i,o.showLabels),this.display(i,e,o.divId),r.displayElement(o),void this.debug("/PlaceSlot initialized.",e);if(null!==n){this.debug("/PlaceSlot position not present, using fallback",[e,n]);var a=ye.getFirstAdSlotDefinition(n);if(null!==a){var s=ye.getFirstAdSlot(n);if(null===s)throw new Error('AdSlot parent not present, even though definition is present. Parent: "'+n+'".');var l=s.divId.replace(s.positionName,e);a=Object.assign(a,{positionName:e,divId:l}),this.defineSlot(i,a),yn.placeSlot(l,t,i,s.showLabels),this.display(i,e,l),this.debug("/PlaceSlot initialized.",e)}else this.debug("/PlaceSlot fallback definition not present.",n)}else this.debug("/PlaceSlot no slot and no fallback present",[e,n])}}},{key:"hideElementByPosition",value:function(e){if(this.positionBlacklist.has(e))this.debug("/hideElementByPosition Ignored. Position blacklisted.",e);else{var t=this.providers.get(Ze.SHORT_NAME);if(!t)throw new Error('/hideElementByPosition Provider "'.concat(Ze.SHORT_NAME,'" is not registered.'));var n=ye.getFirstAdSlot(e);null!==n?t.hideSlot(n):this.debug("/hideElementByPosition No adSlot found.")}}},{key:"processCmds",value:function(){var e=this;if(this.debug("processCmds(), count:",window.smeAdManager.cmd.length),this.blocked)this.debug("execution blocked - skipping processCmds()");else{var t=window.smeAdManager.cmd;this.clearCmds(),t.forEach((function(t){e.blocked?e.debug("execution blocked - skipping exec cmd"):t()}))}}},{key:"biddingEnd",value:function(e,t,n,i){if(this.debug("biddingEnd() for ".concat(e,', position "').concat(t,'", divId "').concat(n,'"; with data'),i),!this.initialized)throw new Error("init() must be called first");if(this.positionBlacklist.has(t))this.debug('adSlot biddingEnd() IGNORED. adSlot.positionName: "'.concat(t,'" is on the position blacklist'));else{var r=this.providers.get(e);if(!r)throw new Error('Provider "'.concat(e,'" is not registered.'));if("etghb"!==e)throw new Error("bidWon() only supported by EtgHB provider");r.biddingEnd(n,i)}}},{key:"toggleRefresh",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.initialized||!this.adRefresher)throw new Error("init() must be called first to toggle refreshing");this.debug("".concat(e?"PAUSE":"RESUME"," slot positions refresh.")),this.adRefresher.toggleState(e)}},{key:"onAdSlotDestroyRequest",value:function(e){if(this.debug('Event "SmeArtemis.advert.destroy" has occurred',e),e instanceof CustomEvent){if(!e.detail&&!e.detail.positionName)throw new Error("Event SmeAdManager.advert.destroy must be called with event.detail");this.destroyByPositionName(e.detail.positionName)}}},{key:"onConsentStateEventHandler",value:function(e){if(this.debug('Event "SmeConsent.stateChange" has occurred',e),e instanceof CustomEvent){if(!e.detail)throw new Error('Event "SmeConsent.stateChange" must be called with event.detail');var t=e.detail;this.userDisplayResolver.setInternalConsentResult(t)?this.triggerSuccessUserRetrieve():this.debug("onConsentStateEventHandler - consent response callback - nothing to handle",t)}}},{key:"triggerSuccessUserRetrieve",value:function(){var e=this.userDisplayResolver.showAdverts();this.debug("UserResolver - callback - with [showAdverts]",e);var t=this.userDisplayResolver.user;if(t&&this.userLoaded(t),!0===e)return this.debug("UserResolver - callback - un-pausing command initializing ad services"),this.setInternalCommandProvidersExecutionPaused(!1),this.userDisplayResolver.ready(),void this.initAdServices();!1===e&&this.userDisplayResolver.propagateDisabledState()}},{key:"destroyByPositionName",value:function(e){this.providers.forEach((function(t){t.getAdSlots("positionName:"+e).forEach((function(e){t.destroy(e),e.lazyObserved&&(e.lazyObserved=!1),e.loadInitialized&&(e.loadInitialized=!1),e.label.reset()}))}))}},{key:"initAdServices",value:function(){var e=this;this.debug("initAdServices - (AdVisibilityResolver) RUN SERVICES",null,!0),null===this.adRefresher?this.adRefresher=new d:this.debug("initAdServices - (AdVisibilityResolver) Already Initialized"),this.providers.forEach((function(t){return t.initialize(e.adRefresher)}))}},{key:"clearCmds",value:function(){var e=this,t=arguments;window.smeAdManager.cmd=[],window.Proxy?window.smeAdManager.cmd=new Proxy(window.smeAdManager.cmd,{set:function(t,n,i){return t[n]=i,e.processCmds(),!0}}):window.smeAdManager.cmd.push=function(){var n=Array.prototype.push.apply(e,t);return e.processCmds(),n}}},{key:"debug",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i.a.log("MAIN"," [t:"+performance.now()+"] "+e,t,n)}},{key:"flushManagerState",value:function(){this.debug("clearing stacked commands"),this.clearCmds(),this.debug("clearing key-value targeting"),this.clearTargeting();var e=ye.getAdSlotNameList();if(this.debug("clearing all adSlots by name",e),e.length>0){var t=this;e.forEach((function(e){t.destroyByPositionName(e)}))}this.providers.forEach((function(e){return e.reset()})),ye.reset()}},{key:"setInternalCommandProvidersExecutionPaused",value:function(e){this.providers.forEach((function(t){return t.setInternalCommandExecutionPaused(e)}))}},{key:"clearTargeting",value:function(){this.providers.forEach((function(e){return e.clearTargeting()}))}},{key:"userLoaded",value:function(e){this.providers.forEach((function(t){return t.onUserLoaded(e)}))}},{key:"reEnqueue",value:function(e){this.MAX_RE_ENQUEUE_COUNT<this.reEnqueueCount?this.debug("reEnqueue limit hit"):(this.reEnqueueCount++,setTimeout((function(){window.smeAdManager.cmd.push(e)}),150+10*this.reEnqueueCount),this.debug("reEnqueue added"))}},{key:"resolvePageContentWidth",value:function(e){var t=h.DEFAULT_PAGE_CONTENT_WIDTH;if("function"==typeof e)try{if(t=e(),isNaN(t))throw new Error("Width not number")}catch(e){this.debug("page content width function error",e)}"number"==typeof e&&(t=e),this.pageContentWidth=t,h.setContentWidth(t)}}])&&An(t.prototype,n),r&&An(t,r),e}(),Cn=n("p46w"),In=n("0/Wv");function Tn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.showAdvert=null,this.userId=null,this.userTokenUpdateUrl=null,this.central=null,this._user=null,this.consentAwait=!1,this.consentResolve=!1,this.consentInitialized=!1,this.consentResolvingHandler=null,this.spaEnabled=!1,this.consentStateResult=null}var t,n,r;return t=e,(n=[{key:"setUserTokenUpdateUrl",value:function(e){this.userTokenUpdateUrl=e}},{key:"setConsentAwait",value:function(e){null!==this.getConsentHandler()?this.consentAwait=e:this.debug("No consent handler present, cannot wait for the resolving. Disabling consent await")}},{key:"setConsentResolve",value:function(e){this.consentAwait?(this.consentResolve=e,!0===this.consentResolve&&this.debug("WARNING ACTIVE CONSENT RESOLVING!",this.consentResolve,!0)):this.debug("Consent resolve can be only applied if `await` is present and already set!")}},{key:"setSpaEnabled",value:function(e){this.spaEnabled=e,this.debug("WARNING SPA user resolving active!",this.spaEnabled,!0)}},{key:"isConsentResolvingEnabled",value:function(){return this.consentResolve}},{key:"userResolvingActive",value:function(){return this.resolveUserSubscription()||this.awaitUserConsent()}},{key:"preActivateUserResolving",value:function(){var e=this;this.debug("preActivateUserResolving - [resolveSubscription: "+this.readableBool(this.resolveUserSubscription())+", awaitConsent: "+this.readableBool(this.awaitUserConsent())+", resolveConsent: "+this.readableBool(this.isConsentResolvingEnabled())),this.fetchUserConsent((function(){e.debug("preActivateUserResolving - success")}),(function(){e.debug("preActivateUserResolving - fail")}))}},{key:"userDataResolved",value:function(){var e=!0,t=!0;return this.resolveUserSubscription()&&(e=this.isUserSubscriptionReady()),this.awaitUserConsent()&&(t=this.isUserConsentReady()),this.debug("userDataResolved - state: [subscriptionReady: "+this.readableBool(e)+", consentReady: "+this.readableBool(t)+"]"),e&&t}},{key:"setInternalConsentResult",value:function(e){if(this.debug("setInternalConsentResult - handling/setting internal consent result",e),null===e)return this.debug("setInternalConsentResult - consent response object is EMPTY",e),!1;var t=e.getError();if(null!==t&&5===t.code&&!1===this.isConsentResolvingEnabled())return null!==this.consentStateResult?(this.debug("setInternalConsentResult - result already set for handling ecmp-timeout",e),!1):(this.debug("setInternalConsentResult - handling ecmp-timeout state (error code 5)",e),this.processCallbackConsentData(e,!1),!0);if(null==t&&!0===this.isConsentResolvingEnabled()){this.debug("setInternalConsentResult - handling ecmp-re-confirm state (success state)",e);var n=this.isAdvertInitEnabledByConsent();return this.processCallbackConsentData(e,!0),!(!1===n&&!0===this.showAdverts()&&5<=this.getSecondsSincePageStart()&&(this.debug("setInternalConsentResult - handling ecmp-re-confirm with PAGE RELOAD",e),document.location.reload(!0),1))}return this.debug("setInternalConsentResult - Consent result state NOT in internal handling whitelist!",e),!1}},{key:"showAdverts",value:function(){var e=this.isAdvertInitEnabledBySubscription(),t=this.isAdvertInitEnabledByConsent();return this.debug("showAdverts - state: [enabledBySubscription: "+this.readableBool(e)+", enabledByConsent:"+this.readableBool(t)+"]"),null===e||null===t?null:e&&t}},{key:"isAdvertInitEnabledByConsent",value:function(){return!1===this.awaitUserConsent()||(!1===this.isConsentResolvingEnabled()?!!this.isUserConsentReady()||null:this.isFullConsentGranted())}},{key:"isAdvertInitEnabledBySubscription",value:function(){return this.resolveUserSubscription()?null!==this.showAdvert?(this.debug("showAdverts - using resolved value, show adverts:",this.showAdvert),this.showAdvert):this.isUserLoggedIn()?this._user?this._user.hasActiveSubscriptionRole("no_advert")?(this.debug("User has active `no_advert` subscription role."),this.showAdvert=!1,this.showAdvert):this._user.hasActiveSubscriptionRole("no_advert_web")?(this.debug("User has active `no_advert_web` subscription role."),this.showAdvert=!1,this.showAdvert):(this.debug("User has NO active `no_advert` or `no_advert_web` subscription role."),this.showAdvert=!0,this.showAdvert):(this.debug("We have no cookie and no variable"),this.showAdvert=null,this.showAdvert):(this.showAdvert=!0,this.showAdvert):(this.debug("showAdverts - user resolving subscription is inactive"),!0)}},{key:"shouldWaitForUserData",value:function(){return this.isUserLoggedIn()?(this.debug("shouldWaitForUserData - we should wait for user data, we have not enough information to show adverts"),!0):(this.debug("shouldWaitForUserData - we are not waiting for user data, because user is not logged in"),!1)}},{key:"retrieveUserData",value:function(e,t){if(!this.userResolvingActive())return this.debug("retrieveUserData - no retrieving required"),void e();var n=!0,i=!0;if(this.resolveUserSubscription()&&!this.isUserSubscriptionReady()?this.fetchUserData(e,t):n=!1,this.awaitUserConsent()&&!this.isUserConsentReady()?this.fetchUserConsent(e,t):i=!1,!n&&!i)return this.debug("retrieveUserData - everything already retrieved - immediate success callback"),void e();this.debug("retrieveUserData - awaiting retrieve [subscription: "+this.readableBool(n)+", consent: "+this.readableBool(i)+" ]")}},{key:"ready",value:function(){window.dispatchEvent(new CustomEvent("SmeAdManager.userDisplay.ready",{}))}},{key:"fetchUserData",value:function(e,t){var n=this;if(null===this.central&&this.userTokenUpdateUrl&&Cn.get("ppi"))return this.debug("Using Central to resolve user"),this.central=new In.Central({tokenUpdateUrl:this.userTokenUpdateUrl}),i.a.enabled&&this.central.setLogger(new In.ConsoleLogger("SmeAdManager")),void this.central.getUser().then((function(t){n._user=t,n.userId=t.id,n.debug("Central JWT loading success",t),e()})).catch((function(e){n.debug("Central JWT ERROR: "+e.message),t()}))}},{key:"resolveUserSubscription",value:function(){return null!==this.userTokenUpdateUrl}},{key:"awaitUserConsent",value:function(){return this.consentInitialized&&this.consentAwait}},{key:"fetchUserConsent",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.awaitUserConsent()||(this.debug("fetchUserConsent - no global consent resolving required or init not called",this.consentStateResult),i)){if(null!==this.consentStateResult)return this.debug("fetchUserConsent - consent already resolved",this.consentStateResult),void e();this.debug("fetchUserConsent - appending consent promise",i);var r=function(t){n.processCallbackConsentData(t,!0),e()},o=function(i){n.processCallbackConsentData(i,!1),!1!==n.isConsentResolvingEnabled()?t():e()};null!==this.getConsentHandler()?this.consentResolvingHandler.then((function(e){r(e)})).catch((function(e){o(e)})):this.debug("fetchUserConsent - consentHandler not present",i)}}},{key:"processCallbackConsentData",value:function(e,t){this.debug("consentResolved - "+(t?"OK":"FAIL"),e,!0),this.consentStateResult=e}},{key:"isUserConsentReady",value:function(){return null!==this.consentStateResult}},{key:"isUserSubscriptionReady",value:function(){return!(!this.spaEnabled||null===this.showAdvert)||!this.shouldWaitForUserData()}},{key:"getConsentHandler",value:function(){return this.consentInitialized||(this.consentResolvingHandler=void 0!==window.smeConsent&&void 0!==window.smeConsent.state?window.smeConsent.state:null,this.consentInitialized=!0),this.consentResolvingHandler}},{key:"propagateDisabledState",value:function(){fe.disabledState(),p.attachDisabledStateToBody()}},{key:"isFullConsentGranted",value:function(){if(!1===this.isConsentResolvingEnabled())return this.debug("isFullConsentGranted - calling resolve with option to not resolve. STOP. Responding with true"),!0;if(null===this.consentStateResult)return null;var e=this.consentStateResult;return void 0!==e.isFullConsentGranted&&!0===e.isFullConsentGranted()?(this.debug("isFullConsentGranted - Has full consent",e,!0),!0):(this.debug("isFullConsentGranted - No full consent - state: "+e.getState().key,e),!1)}},{key:"isUserLoggedIn",value:function(){if(null!==this._user)return!0;if(null!==this.userId)return!0;var e=Cn.get("ppi");if(void 0===e)return this.debug("User is not logged in"),!1;var t=this.toInt(e);return!t||t<=0?(this.debug("User is not logged in, invalid ID",t),!1):(this.userId=t,this.debug("User is logged in"),!0)}},{key:"readableBool",value:function(e){return null===e?"unknown":e?"yes":"no"}},{key:"toInt",value:function(e){if(isNaN(e))return null;var t=parseInt(e,10);return isNaN(e)?null:t}},{key:"getSecondsSincePageStart",value:function(){return Math.floor(performance.now()/1e3)}},{key:"debug",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i.a.log("AdVisibilityResolver"," [t:"+performance.now()+"] "+e,t,n)}},{key:"user",get:function(){return this._user}}])&&Tn(t.prototype,n),r&&Tn(t,r),e}();window.smeAdManager=window.smeAdManager||{},window.googletag=window.googletag||{},window.localSmeVideoAdvert=null;var Rn=window.smeAdManager;Rn.cmd=Rn.cmd||[],Rn.journal=Rn.journal||[],void 0===window.smeAdvertLayoutType&&(window.smeAdvertLayoutType=function(){return(window.innerWidth||document.documentElement.clientWidth||document.documentElement.getElementsByTagName("body")[0].clientWidth)<600?"responsive_1":"original"}),window.viewPortSize=[window.smeViewPortWidth||0,0],Rn.userDisplayResolver=new Pn,Rn.mngr=new On(Rn.userDisplayResolver),Rn.mngr.processCmds()},hjvm:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s}));var i="start",r="complete",o="error",a="skipped",s="end"},p46w:function(e,t,n){var i,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(o){if(void 0===(r="function"==typeof(i=o)?i.call(t,n,t,e):i)||(e.exports=r),!0,e.exports=o(),!!0){var a=window.Cookies,s=window.Cookies=o();s.noConflict=function(){return window.Cookies=a,s}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(i){function r(){}function o(t,n,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=i.write?i.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var l in o)o[l]&&(s+="; "+l,!0!==o[l]&&(s+="="+o[l].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),l=s.slice(1).join("=");n||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var u=t(s[0]);if(l=(i.read||i)(l,u)||t(l),n)try{l=JSON.parse(l)}catch(e){}if(r[u]=l,e===u)break}catch(e){}}return e?r[e]:r}}return r.set=o,r.get=function(e){return a(e,!1)},r.getJSON=function(e){return a(e,!0)},r.remove=function(t,n){o(t,"",e(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}((function(){}))}))},"tL+y":function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return r}));var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._enabled=!1,this._withTime=!1,this.STYLE_NAMESPACE="background:grey;color:black",this.STYLE_MESSAGE="background:blue;color:white",(0<window.location.hash.indexOf("advmngrDebug")||0<window.location.host.indexOf("localhost"))&&(this.enabled=!0),0<window.location.hash.indexOf("--time")&&(this.withTime=!0)}var t,n,r;return t=e,(n=[{key:"log",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.enabled){var r=this.withTime?" [t:"+performance.now()+"]":"";t="[SMEADVM - ".concat(e,"]").concat(r," ").concat(t),i&&(t="%c [SMEADVM - ".concat(e,"]").concat(r," %c ").concat(t)),n&&i?console.debug(t,this.STYLE_NAMESPACE,this.STYLE_MESSAGE,n):n?console.debug(t,n):i?console.debug(t,this.STYLE_NAMESPACE,this.STYLE_MESSAGE):console.debug(t)}}},{key:"enabled",set:function(e){this._enabled=e},get:function(){return this._enabled}},{key:"withTime",set:function(e){this._withTime=e},get:function(){return this._withTime}}])&&i(t.prototype,n),r&&i(t,r),e}())}});